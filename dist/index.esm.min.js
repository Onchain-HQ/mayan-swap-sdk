var d={MAYAN_FORWARDER_CONTRACT:"0x337685fdaB40D39bd02028545a4FfA7D287cC3E2",MAYAN_PROGRAM_ID:"FC4eXxkyrMPTjiYUpp4EAnkmwMbQyZ6NDCh1kfLn6vsf",AUCTION_PROGRAM_ID:"8QJmxZcEzwuYmCPy6XqgN2sHcYCcFq6AEfBMJZZuLo5a",MCTP_PROGRAM_ID:"dkpZqrxHFrhziEMQ931GLtfy11nFkCsfMftH9u6QwBU",SWIFT_PROGRAM_ID:"BLZRi6frs4X4DNLw56V4EXai1b6QVESN1BhHBTYM9VcY",FEE_MANAGER_PROGRAM_ID:"5VtQHnhs2pfVEr68qQsbTRwKh4JV5GTu9mBHgHFxpHeQ",WORMHOLE_PROGRAM_ID:"worm2ZoG2kUd4vFXhvjh93UUH596ayRfgQ2MgjNMTth",CCTP_CORE_PROGRAM_ID:"CCTPmbSD7gX1bxKPAmg77w8oFzNFpaQiQUWD43TKaecd",CCTP_TOKEN_PROGRAM_ID:"CCTPiPYPc6AsJuwueEnWgSgucamXDZwBd53dQ11YiKX3",TOKEN_PROGRAM_ID:"TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA",TOKEN_2022_PROGRAM_ID:"TokenzQdBNbLqP5VEhdkAS6EPFLC1PHnBqCXEpPxuEb",ASSOCIATED_TOKEN_PROGRAM_ID:"ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL",SPL_UTILS_PROGRAM_ID:"B96dV3Luxzo6SokJx3xt8i5y8Mb7HRR6Eec8hCjJDT69",LOOKUP_TABLE:"75X8YgJPcadksw6Ag3qsYUfi1bsFwDoCKYtqPPqdydAG",SUI_MCTP_STATE:"0xb787fe0f7530b4fd2162fa0cc92f4f6c5a97c54b4c5c55eb04ab29f4b803ac9c",SUI_MCTP_FEE_MANAGER_STATE:"0xa1b4a96ce93d36dd0bbce0adc39533a07d2f32928918c80cd6fe7868320978f2",SUI_CCTP_CORE_PACKAGE_ID:"0x08d87d37ba49e785dde270a83f8e979605b03dc552b5548f26fdf2f49bf7ed1b",SUI_CCTP_CORE_STATE:"0xf68268c3d9b1df3215f2439400c1c4ea08ac4ef4bb7d6f3ca6a2a239e17510af",SUI_CCTP_TOKEN_PACKAGE_ID:"0x2aa6c5d56376c371f88a6cc42e852824994993cb9bab8d3e6450cbe3cb32b94e",SUI_CCTP_TOKEN_STATE:"0x45993eecc0382f37419864992c12faee2238f5cfe22b98ad3bf455baf65c8a2f",SUI_WORMHOLE_PACKAGE_ID:"0x5306f64e312b581766351c07af79c72fcb1cd25147157fdc2f8ad76de9a3fb6a",SUI_WORMHOLE_STATE:"0xaeab97f96cf9877fee2883315d459552b2b921edc16d7ceac6eab944dd88919c",SUI_LOGGER_PACKAGE_ID:"0x05680e9030c147b413a489f7891273acc221d49bd061c433e5771bc170fc37ac",EXPLORER_URL:"https://explorer-api.mayan.finance/v3",PRICE_URL:"https://price-api.mayan.finance/v3",RELAYER_URL:"https://relayer-api.mayan.finance/v3"};import{zeroPadValue as Ve,parseUnits as Kn,formatUnits as Ln,keccak256 as Un}from"ethers";import{PublicKey as Ae,SystemProgram as dt}from"@solana/web3.js";var Gn=e=>/^(0x)?[0-9a-fA-F]+::\w+::\w+$/.test(e);function A(e,t){if(t===1)return Ve(new Ae(e).toBytes(),32);if(t===G.ethereum||t===G.bsc||t===G.polygon||t===G.avalanche||t===G.arbitrum||t===G.optimism||t===G.base||t===G.unichain||t===G.linea)return Ve(e,32);if(t===G.aptos&&Gn(e))return Un(e);if(t===G.sui){let n=e.startsWith("0x")?e.substring(2):e;if(Buffer.from(n,"hex").length!==32)throw new Error("Invalid sui address: "+e);return Ve(e,32)}else throw console.log(`Unsupported chain id: ${t}`,e),new Error("Unsupported token chain")}function N(e){return new Uint8Array(Buffer.from(e.startsWith("0x")?e.substring(2):e,"hex"))}function F(e,t,n=!1,a=new Ae(d.TOKEN_PROGRAM_ID),i=new Ae(d.ASSOCIATED_TOKEN_PROGRAM_ID)){if(!n&&!Ae.isOnCurve(t.toBuffer()))throw new Error("TokenOwnerOffCurveError");let[o]=Ae.findProgramAddressSync([t.toBuffer(),a.toBuffer(),e.toBuffer()],i);return o}function w(e,t){if(e==null)throw new Error("getAmountOfFractionalAmount: Amount is null or undefined");if(typeof e!="string"&&typeof e!="number")throw new Error("getAmountOfFractionalAmount: Amount is not a string or number");if(typeof e=="string"&&e.length===0)throw new Error("getAmountOfFractionalAmount: Amount is empty");if(!Number.isFinite(Number(e)))throw new Error("getAmountOfFractionalAmount: Amount is not a number");let n=Math.min(8,Number(t)),a=Number(e).toFixed(n+1),i=new RegExp(`^-?\\d+(?:\\.\\d{0,${n}})?`),o=a.match(i);if(!o)throw new Error("getAmountOfFractionalAmount: fixedAmount is null");let s=o[0];return Kn(s,Number(t))}function va(e,t){return Number(Ln(e,t))}var G={solana:1,ethereum:2,bsc:4,polygon:5,avalanche:6,arbitrum:23,optimism:24,base:30,aptos:22,sui:21,unichain:44,linea:38};function k(e){return G[e]}var Ye={[1]:2,[56]:4,[137]:5,[43114]:6,[42161]:23,[10]:24,[8453]:30,[130]:44,[59144]:38};function mt(e){let t=G[e],n=Object.keys(Ye);for(let a of n)if(Ye[a]===t)return Number(a);throw new Error(`Unsupported chain: ${e}`)}function H(e){return Ye[e]}var de=[10,5,0];function $e(){return de.join("_")}function ft(e){return de[0]<e[0]?!1:de[0]>e[0]?!0:de[1]<e[1]?!1:de[1]>e[1]||de[2]>=e[2]}function B(e){return e==="solana"?9:18}function bt(e){return e==="solana"?9:8}var Hn=BigInt(2)**BigInt(64)-BigInt(1);function _(e){if(e<BigInt(0)||e>Hn)throw new Error(`Invalid u64: ${e}`);let t=Buffer.alloc(8);return t.writeBigUInt64LE(e),t}var X={value:BigInt(0),deadline:0,v:0,r:`0x${dt.programId.toBuffer().toString("hex")}`,s:`0x${dt.programId.toBuffer().toString("hex")}`};function ke(e){return new Promise(t=>{setTimeout(()=>{t()},e)})}function he(e,t){return!e||!t?null:e.type==="WH"?t?.solana||null:e.type==="MCTP"||e.type==="SWIFT"?e.toChain==="solana"?t?.solana||null:e.toChain==="sui"?t?.sui||null:t?.evm||null:null}var Tt=1,gt=2,Na=1,wt=1,At=2,ht=3;function ze(e){return Object.entries(e).filter(([t,n])=>n!=null&&!Array.isArray(n)).map(([t,n])=>`${encodeURIComponent(t)}=${encodeURIComponent(n)}`).join("&")}async function re(e){if(e.status.toString().startsWith("5")){let t;try{let n=await e.json();(n?.code||n?.statusCode)&&(n?.message||n?.msg)&&(t={code:n?.code||n?.statusCode,message:n?.message||n?.msg})}catch{t=new Error("Internal server error")}throw t}}async function Ua(e){let t=e?`?standard=${e.join(",")}`:"",n=await fetch(`${d.PRICE_URL}/tokens${t}`,{method:"GET",redirect:"follow"});if(await re(n),n.status===200)return await n.json();throw new Error("Cannot fetch Mayan tokens!")}async function Ga(e,t=!1,n){let a={chain:e,nonPortal:t,standard:n?n?.join(","):void 0},i=await fetch(`${d.PRICE_URL}/tokens?${ze(a)}`);if(await re(i),i.status===200)return(await i.json())[e];throw new Error("Cannot fetch Mayan tokens!")}function Qn(e,t={wormhole:!0,swift:!0,mctp:!0,shuttle:!0,gasless:!1,onlyDirect:!1,fastMctp:!0}){let{gasDrop:n,referrerBps:a}=e,i=e.slippageBps;i!=="auto"&&!Number.isFinite(i)&&(i=e.slippage*100);let s={...{wormhole:t.wormhole!==!1,swift:t.swift!==!1,mctp:t.mctp!==!1,shuttle:t.shuttle===!0,fastMctp:t.fastMctp!==!1,gasless:t.gasless===!0,onlyDirect:t.onlyDirect===!0},solanaProgram:d.MAYAN_PROGRAM_ID,forwarderAddress:d.MAYAN_FORWARDER_CONTRACT,amountIn:!e.amountIn64&&Number.isFinite(e.amount)?e.amount:void 0,amountIn64:e.amountIn64,fromToken:e.fromToken,fromChain:e.fromChain,toToken:e.toToken,toChain:e.toChain,slippageBps:i,referrer:e.referrer,referrerBps:Number.isFinite(a)?a:void 0,gasDrop:Number.isFinite(n)?n:void 0,sdkVersion:$e()},r=`${d.PRICE_URL}/quote?`,c=ze(s);return r+c}async function Ha(e,t={swift:!0,mctp:!0,gasless:!1,onlyDirect:!1}){let n=Qn(e,t),a=await fetch(n,{method:"GET",redirect:"follow"});await re(a);let i=await a.json();if(a.status!==200&&a.status!==201)throw{code:i?.code||0,message:i?.msg||i?.message||"Route not found",data:i?.data};if(!ft(i.minimumSdkVersion))throw{code:9999,message:"Swap SDK is outdated!"};return i.quotes}async function Qa(e){let t=await fetch(`${d.PRICE_URL}/clock/${e}`,{method:"GET",redirect:"follow"});await re(t);let n=await t.json();if(t.status!==200&&t.status!==201)throw n;return n.clock}async function It(){let e=await fetch(`${d.RELAYER_URL}/active-relayers?solanaProgram=${d.MAYAN_PROGRAM_ID}`,{method:"GET",redirect:"follow"});await re(e);let t=await e.json();if(e.status!==200&&e.status!==201)throw t;return t.suggested}async function Re(e){let t=ze({...e,sdkVersion:$e()}),n=await fetch(`${d.PRICE_URL}/get-swap/solana?${t}`,{method:"GET",redirect:"follow"});await re(n);let a=await n.json();if(n.status!==200&&n.status!==201)throw a;return a}async function Mt(e,t){let n=await fetch(`${d.EXPLORER_URL}/submit/evm`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...e,signature:t},(a,i)=>typeof i=="bigint"?i.toString():i)});await re(n)}async function St(e){let t=await fetch(`${d.EXPLORER_URL}/submit/solana`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({signedTx:e})});await re(t);let n=await t.json();if(t.status!==200&&t.status!==201)throw n;return n}import{Contract as Sn,toBeHex as Pn,ZeroAddress as Cn}from"ethers";import{PublicKey as lt,SystemProgram as _a}from"@solana/web3.js";var Pt={_format:"hh-sol-artifact-1",contractName:"MayanSwap",sourceName:"src/MayanSwap.sol",abi:[{inputs:[{internalType:"address",name:"_tokenBridge",type:"address"},{internalType:"address",name:"_weth",type:"address"}],stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!0,internalType:"uint16",name:"emitterChainId",type:"uint16"},{indexed:!0,internalType:"bytes32",name:"emitterAddress",type:"bytes32"},{indexed:!0,internalType:"uint64",name:"sequence",type:"uint64"}],name:"Redeemed",type:"event"},{inputs:[{internalType:"address",name:"newGuardian",type:"address"}],name:"changeGuardian",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"claimGuardian",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{components:[{internalType:"uint8",name:"payloadId",type:"uint8"},{internalType:"bytes32",name:"tokenAddr",type:"bytes32"},{internalType:"uint16",name:"tokenChainId",type:"uint16"},{internalType:"bytes32",name:"destAddr",type:"bytes32"},{internalType:"uint16",name:"destChainId",type:"uint16"},{internalType:"bytes32",name:"sourceAddr",type:"bytes32"},{internalType:"uint16",name:"sourceChainId",type:"uint16"},{internalType:"uint64",name:"sequence",type:"uint64"},{internalType:"uint64",name:"amountOutMin",type:"uint64"},{internalType:"uint64",name:"deadline",type:"uint64"},{internalType:"uint64",name:"swapFee",type:"uint64"},{internalType:"uint64",name:"redeemFee",type:"uint64"},{internalType:"uint64",name:"refundFee",type:"uint64"},{internalType:"bytes32",name:"auctionAddr",type:"bytes32"},{internalType:"bool",name:"unwrapRedeem",type:"bool"},{internalType:"bool",name:"unwrapRefund",type:"bool"}],internalType:"struct MayanStructs.Swap",name:"s",type:"tuple"}],name:"encodeSwap",outputs:[{internalType:"bytes",name:"encoded",type:"bytes"}],stateMutability:"pure",type:"function"},{inputs:[],name:"getWeth",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"isPaused",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes",name:"encoded",type:"bytes"}],name:"parseRedeemPayload",outputs:[{components:[{internalType:"uint8",name:"payloadId",type:"uint8"},{internalType:"bytes32",name:"recipient",type:"bytes32"},{internalType:"uint64",name:"relayerFee",type:"uint64"},{internalType:"bool",name:"unwrap",type:"bool"},{internalType:"uint64",name:"gasDrop",type:"uint64"},{internalType:"bytes",name:"customPayload",type:"bytes"}],internalType:"struct MayanStructs.Redeem",name:"r",type:"tuple"}],stateMutability:"pure",type:"function"},{inputs:[{internalType:"bytes",name:"encodedVm",type:"bytes"}],name:"redeem",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"bytes",name:"encodedVm",type:"bytes"}],name:"redeemAndUnwrap",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bool",name:"_pause",type:"bool"}],name:"setPause",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{components:[{internalType:"uint64",name:"swapFee",type:"uint64"},{internalType:"uint64",name:"redeemFee",type:"uint64"},{internalType:"uint64",name:"refundFee",type:"uint64"}],internalType:"struct MayanSwap.RelayerFees",name:"relayerFees",type:"tuple"},{components:[{internalType:"bytes32",name:"mayanAddr",type:"bytes32"},{internalType:"uint16",name:"mayanChainId",type:"uint16"},{internalType:"bytes32",name:"auctionAddr",type:"bytes32"},{internalType:"bytes32",name:"destAddr",type:"bytes32"},{internalType:"uint16",name:"destChainId",type:"uint16"},{internalType:"bytes32",name:"referrer",type:"bytes32"},{internalType:"bytes32",name:"refundAddr",type:"bytes32"}],internalType:"struct MayanSwap.Recepient",name:"recipient",type:"tuple"},{internalType:"bytes32",name:"tokenOutAddr",type:"bytes32"},{internalType:"uint16",name:"tokenOutChainId",type:"uint16"},{components:[{internalType:"uint256",name:"transferDeadline",type:"uint256"},{internalType:"uint64",name:"swapDeadline",type:"uint64"},{internalType:"uint64",name:"amountOutMin",type:"uint64"},{internalType:"bool",name:"unwrap",type:"bool"},{internalType:"uint64",name:"gasDrop",type:"uint64"},{internalType:"bytes",name:"customPayload",type:"bytes"}],internalType:"struct MayanSwap.Criteria",name:"criteria",type:"tuple"},{internalType:"address",name:"tokenIn",type:"address"},{internalType:"uint256",name:"amountIn",type:"uint256"}],name:"swap",outputs:[{internalType:"uint64",name:"sequence",type:"uint64"}],stateMutability:"payable",type:"function"},{inputs:[{internalType:"uint256",name:"amount",type:"uint256"},{internalType:"address payable",name:"to",type:"address"}],name:"sweepEth",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"token",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"},{internalType:"address",name:"to",type:"address"}],name:"sweepToken",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{components:[{internalType:"uint64",name:"swapFee",type:"uint64"},{internalType:"uint64",name:"redeemFee",type:"uint64"},{internalType:"uint64",name:"refundFee",type:"uint64"}],internalType:"struct MayanSwap.RelayerFees",name:"relayerFees",type:"tuple"},{components:[{internalType:"bytes32",name:"mayanAddr",type:"bytes32"},{internalType:"uint16",name:"mayanChainId",type:"uint16"},{internalType:"bytes32",name:"auctionAddr",type:"bytes32"},{internalType:"bytes32",name:"destAddr",type:"bytes32"},{internalType:"uint16",name:"destChainId",type:"uint16"},{internalType:"bytes32",name:"referrer",type:"bytes32"},{internalType:"bytes32",name:"refundAddr",type:"bytes32"}],internalType:"struct MayanSwap.Recepient",name:"recipient",type:"tuple"},{internalType:"bytes32",name:"tokenOutAddr",type:"bytes32"},{internalType:"uint16",name:"tokenOutChainId",type:"uint16"},{components:[{internalType:"uint256",name:"transferDeadline",type:"uint256"},{internalType:"uint64",name:"swapDeadline",type:"uint64"},{internalType:"uint64",name:"amountOutMin",type:"uint64"},{internalType:"bool",name:"unwrap",type:"bool"},{internalType:"uint64",name:"gasDrop",type:"uint64"},{internalType:"bytes",name:"customPayload",type:"bytes"}],internalType:"struct MayanSwap.Criteria",name:"criteria",type:"tuple"}],name:"wrapAndSwapETH",outputs:[{internalType:"uint64",name:"sequence",type:"uint64"}],stateMutability:"payable",type:"function"},{stateMutability:"payable",type:"receive"}]};var q={_format:"hh-sol-artifact-1",contractName:"MayanForwarder",sourceName:"src/MayanForwarder.sol",abi:[{inputs:[{internalType:"address",name:"_guardian",type:"address"},{internalType:"address[]",name:"_swapProtocols",type:"address[]"},{internalType:"address[]",name:"_mayanProtocols",type:"address[]"}],stateMutability:"nonpayable",type:"constructor"},{inputs:[],name:"UnsupportedProtocol",type:"error"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"token",type:"address"},{indexed:!1,internalType:"uint256",name:"amount",type:"uint256"},{indexed:!1,internalType:"address",name:"mayanProtocol",type:"address"},{indexed:!1,internalType:"bytes",name:"protocolData",type:"bytes"}],name:"ForwardedERC20",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"mayanProtocol",type:"address"},{indexed:!1,internalType:"bytes",name:"protocolData",type:"bytes"}],name:"ForwardedEth",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint256",name:"amount",type:"uint256"}],name:"SwapAndForwarded",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"tokenIn",type:"address"},{indexed:!1,internalType:"uint256",name:"amountIn",type:"uint256"},{indexed:!1,internalType:"address",name:"swapProtocol",type:"address"},{indexed:!1,internalType:"address",name:"middleToken",type:"address"},{indexed:!1,internalType:"uint256",name:"middleAmount",type:"uint256"},{indexed:!1,internalType:"address",name:"mayanProtocol",type:"address"},{indexed:!1,internalType:"bytes",name:"mayanData",type:"bytes"}],name:"SwapAndForwardedERC20",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint256",name:"amountIn",type:"uint256"},{indexed:!1,internalType:"address",name:"swapProtocol",type:"address"},{indexed:!1,internalType:"address",name:"middleToken",type:"address"},{indexed:!1,internalType:"uint256",name:"middleAmount",type:"uint256"},{indexed:!1,internalType:"address",name:"mayanProtocol",type:"address"},{indexed:!1,internalType:"bytes",name:"mayanData",type:"bytes"}],name:"SwapAndForwardedEth",type:"event"},{inputs:[{internalType:"address",name:"newGuardian",type:"address"}],name:"changeGuardian",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"claimGuardian",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"tokenIn",type:"address"},{internalType:"uint256",name:"amountIn",type:"uint256"},{components:[{internalType:"uint256",name:"value",type:"uint256"},{internalType:"uint256",name:"deadline",type:"uint256"},{internalType:"uint8",name:"v",type:"uint8"},{internalType:"bytes32",name:"r",type:"bytes32"},{internalType:"bytes32",name:"s",type:"bytes32"}],internalType:"struct MayanForwarder.PermitParams",name:"permitParams",type:"tuple"},{internalType:"address",name:"mayanProtocol",type:"address"},{internalType:"bytes",name:"protocolData",type:"bytes"}],name:"forwardERC20",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"address",name:"mayanProtocol",type:"address"},{internalType:"bytes",name:"protocolData",type:"bytes"}],name:"forwardEth",outputs:[],stateMutability:"payable",type:"function"},{inputs:[],name:"guardian",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"}],name:"mayanProtocols",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"nextGuardian",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"amount",type:"uint256"},{internalType:"address payable",name:"to",type:"address"}],name:"rescueEth",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"token",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"},{internalType:"address",name:"to",type:"address"}],name:"rescueToken",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"mayanProtocol",type:"address"},{internalType:"bool",name:"enabled",type:"bool"}],name:"setMayanProtocol",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"swapProtocol",type:"address"},{internalType:"bool",name:"enabled",type:"bool"}],name:"setSwapProtocol",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"tokenIn",type:"address"},{internalType:"uint256",name:"amountIn",type:"uint256"},{components:[{internalType:"uint256",name:"value",type:"uint256"},{internalType:"uint256",name:"deadline",type:"uint256"},{internalType:"uint8",name:"v",type:"uint8"},{internalType:"bytes32",name:"r",type:"bytes32"},{internalType:"bytes32",name:"s",type:"bytes32"}],internalType:"struct MayanForwarder.PermitParams",name:"permitParams",type:"tuple"},{internalType:"address",name:"swapProtocol",type:"address"},{internalType:"bytes",name:"swapData",type:"bytes"},{internalType:"address",name:"middleToken",type:"address"},{internalType:"uint256",name:"minMiddleAmount",type:"uint256"},{internalType:"address",name:"mayanProtocol",type:"address"},{internalType:"bytes",name:"mayanData",type:"bytes"}],name:"swapAndForwardERC20",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"uint256",name:"amountIn",type:"uint256"},{internalType:"address",name:"swapProtocol",type:"address"},{internalType:"bytes",name:"swapData",type:"bytes"},{internalType:"address",name:"middleToken",type:"address"},{internalType:"uint256",name:"minMiddleAmount",type:"uint256"},{internalType:"address",name:"mayanProtocol",type:"address"},{internalType:"bytes",name:"mayanData",type:"bytes"}],name:"swapAndForwardEth",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"}],name:"swapProtocols",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"}],linkReferences:{},deployedLinkReferences:{}};import{Contract as Ze,toBeHex as j,ZeroAddress as je}from"ethers";import{SystemProgram as Ct}from"@solana/web3.js";var Je={_format:"hh-sol-artifact-1",contractName:"MayanCircle",sourceName:"src/MayanCircle.sol",abi:[{inputs:[{internalType:"address",name:"_cctpTokenMessenger",type:"address"},{internalType:"address",name:"_wormhole",type:"address"},{internalType:"address",name:"_feeManager",type:"address"},{internalType:"uint16",name:"_auctionChainId",type:"uint16"},{internalType:"bytes32",name:"_auctionAddr",type:"bytes32"},{internalType:"uint8",name:"_consistencyLevel",type:"uint8"}],stateMutability:"nonpayable",type:"constructor"},{inputs:[],name:"CallerAlreadySet",type:"error"},{inputs:[],name:"CallerNotSet",type:"error"},{inputs:[],name:"CctpReceiveFailed",type:"error"},{inputs:[],name:"DeadlineViolation",type:"error"},{inputs:[],name:"DomainAlreadySet",type:"error"},{inputs:[],name:"DomainNotSet",type:"error"},{inputs:[],name:"EmitterAlreadySet",type:"error"},{inputs:[],name:"EthTransferFailed",type:"error"},{inputs:[],name:"InvalidAction",type:"error"},{inputs:[],name:"InvalidAddress",type:"error"},{inputs:[],name:"InvalidAmountOut",type:"error"},{inputs:[],name:"InvalidCaller",type:"error"},{inputs:[],name:"InvalidDestAddr",type:"error"},{inputs:[],name:"InvalidDomain",type:"error"},{inputs:[],name:"InvalidEmitter",type:"error"},{inputs:[],name:"InvalidGasDrop",type:"error"},{inputs:[],name:"InvalidMintRecipient",type:"error"},{inputs:[],name:"InvalidNonce",type:"error"},{inputs:[],name:"InvalidOrder",type:"error"},{inputs:[],name:"InvalidPayload",type:"error"},{inputs:[],name:"InvalidProtocolFee",type:"error"},{inputs:[],name:"InvalidRedeemFee",type:"error"},{inputs:[],name:"InvalidReferrerFee",type:"error"},{inputs:[],name:"MintRecipientAlreadySet",type:"error"},{inputs:[],name:"MintRecipientNotSet",type:"error"},{inputs:[],name:"Paused",type:"error"},{inputs:[],name:"Unauthorized",type:"error"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint32",name:"sourceDomain",type:"uint32"},{indexed:!1,internalType:"uint64",name:"sourceNonce",type:"uint64"},{indexed:!1,internalType:"uint256",name:"amount",type:"uint256"}],name:"OrderFulfilled",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint32",name:"sourceDomain",type:"uint32"},{indexed:!1,internalType:"uint64",name:"sourceNonce",type:"uint64"},{indexed:!1,internalType:"uint256",name:"amount",type:"uint256"}],name:"OrderRefunded",type:"event"},{inputs:[],name:"auctionAddr",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[],name:"auctionChainId",outputs:[{internalType:"uint16",name:"",type:"uint16"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"tokenIn",type:"address"},{internalType:"uint256",name:"amountIn",type:"uint256"},{internalType:"uint64",name:"redeemFee",type:"uint64"},{internalType:"uint64",name:"gasDrop",type:"uint64"},{internalType:"bytes32",name:"destAddr",type:"bytes32"},{internalType:"uint32",name:"destDomain",type:"uint32"},{internalType:"uint8",name:"payloadType",type:"uint8"},{internalType:"bytes",name:"customPayload",type:"bytes"}],name:"bridgeWithFee",outputs:[{internalType:"uint64",name:"sequence",type:"uint64"}],stateMutability:"payable",type:"function"},{inputs:[{internalType:"address",name:"tokenIn",type:"address"},{internalType:"uint256",name:"amountIn",type:"uint256"},{internalType:"uint64",name:"gasDrop",type:"uint64"},{internalType:"uint256",name:"redeemFee",type:"uint256"},{internalType:"uint32",name:"destDomain",type:"uint32"},{internalType:"bytes32",name:"destAddr",type:"bytes32"}],name:"bridgeWithLockedFee",outputs:[{internalType:"uint64",name:"cctpNonce",type:"uint64"}],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"cctpTokenMessenger",outputs:[{internalType:"contract ITokenMessenger",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint16",name:"",type:"uint16"}],name:"chainIdToEmitter",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"newGuardian",type:"address"}],name:"changeGuardian",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"claimGuardian",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"consistencyLevel",outputs:[{internalType:"uint8",name:"",type:"uint8"}],stateMutability:"view",type:"function"},{inputs:[{components:[{internalType:"address",name:"tokenIn",type:"address"},{internalType:"uint256",name:"amountIn",type:"uint256"},{internalType:"uint64",name:"gasDrop",type:"uint64"},{internalType:"bytes32",name:"destAddr",type:"bytes32"},{internalType:"uint16",name:"destChain",type:"uint16"},{internalType:"bytes32",name:"tokenOut",type:"bytes32"},{internalType:"uint64",name:"minAmountOut",type:"uint64"},{internalType:"uint64",name:"deadline",type:"uint64"},{internalType:"uint64",name:"redeemFee",type:"uint64"},{internalType:"bytes32",name:"referrerAddr",type:"bytes32"},{internalType:"uint8",name:"referrerBps",type:"uint8"}],internalType:"struct MayanCircle.OrderParams",name:"params",type:"tuple"}],name:"createOrder",outputs:[{internalType:"uint64",name:"sequence",type:"uint64"}],stateMutability:"payable",type:"function"},{inputs:[{internalType:"uint32",name:"",type:"uint32"}],name:"domainToCaller",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[],name:"feeManager",outputs:[{internalType:"contract IFeeManager",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint64",name:"",type:"uint64"}],name:"feeStorage",outputs:[{internalType:"bytes32",name:"destAddr",type:"bytes32"},{internalType:"uint64",name:"gasDrop",type:"uint64"},{internalType:"address",name:"token",type:"address"},{internalType:"uint256",name:"redeemFee",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes",name:"cctpMsg",type:"bytes"},{internalType:"bytes",name:"cctpSigs",type:"bytes"},{internalType:"bytes",name:"encodedVm",type:"bytes"},{components:[{internalType:"bytes32",name:"destAddr",type:"bytes32"},{internalType:"uint16",name:"destChainId",type:"uint16"},{internalType:"bytes32",name:"tokenOut",type:"bytes32"},{internalType:"uint64",name:"promisedAmount",type:"uint64"},{internalType:"uint64",name:"gasDrop",type:"uint64"},{internalType:"uint64",name:"redeemFee",type:"uint64"},{internalType:"uint64",name:"deadline",type:"uint64"},{internalType:"bytes32",name:"referrerAddr",type:"bytes32"},{internalType:"uint8",name:"referrerBps",type:"uint8"},{internalType:"uint8",name:"protocolBps",type:"uint8"},{internalType:"bytes32",name:"driver",type:"bytes32"}],internalType:"struct MayanCircle.FulfillParams",name:"params",type:"tuple"},{internalType:"address",name:"swapProtocol",type:"address"},{internalType:"bytes",name:"swapData",type:"bytes"}],name:"fulfillOrder",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"uint16",name:"chainId",type:"uint16"}],name:"getDomain",outputs:[{internalType:"uint32",name:"domain",type:"uint32"}],stateMutability:"view",type:"function"},{inputs:[],name:"guardian",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"isPaused",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32",name:"",type:"bytes32"}],name:"keyToMintRecipient",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[],name:"localDomain",outputs:[{internalType:"uint32",name:"",type:"uint32"}],stateMutability:"view",type:"function"},{inputs:[],name:"paused",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes",name:"cctpMsg",type:"bytes"},{internalType:"bytes",name:"cctpSigs",type:"bytes"},{internalType:"bytes",name:"encodedVm",type:"bytes"},{components:[{internalType:"uint8",name:"payloadType",type:"uint8"},{internalType:"bytes32",name:"destAddr",type:"bytes32"},{internalType:"uint64",name:"gasDrop",type:"uint64"},{internalType:"uint64",name:"redeemFee",type:"uint64"},{internalType:"uint64",name:"burnAmount",type:"uint64"},{internalType:"bytes32",name:"burnToken",type:"bytes32"},{internalType:"bytes32",name:"customPayload",type:"bytes32"}],internalType:"struct MayanCircle.BridgeWithFeeParams",name:"bridgeParams",type:"tuple"}],name:"redeemWithFee",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"bytes",name:"cctpMsg",type:"bytes"},{internalType:"bytes",name:"cctpSigs",type:"bytes"},{internalType:"bytes32",name:"unlockerAddr",type:"bytes32"}],name:"redeemWithLockedFee",outputs:[{internalType:"uint64",name:"sequence",type:"uint64"}],stateMutability:"payable",type:"function"},{inputs:[{internalType:"uint32",name:"cctpNonce",type:"uint32"},{internalType:"uint32",name:"cctpDomain",type:"uint32"},{internalType:"bytes32",name:"destAddr",type:"bytes32"},{internalType:"bytes32",name:"unlockerAddr",type:"bytes32"}],name:"refineFee",outputs:[{internalType:"uint64",name:"sequence",type:"uint64"}],stateMutability:"payable",type:"function"},{inputs:[{internalType:"bytes",name:"encodedVm",type:"bytes"},{internalType:"bytes",name:"cctpMsg",type:"bytes"},{internalType:"bytes",name:"cctpSigs",type:"bytes"},{components:[{internalType:"address",name:"tokenIn",type:"address"},{internalType:"uint256",name:"amountIn",type:"uint256"},{internalType:"uint64",name:"gasDrop",type:"uint64"},{internalType:"bytes32",name:"destAddr",type:"bytes32"},{internalType:"uint16",name:"destChain",type:"uint16"},{internalType:"bytes32",name:"tokenOut",type:"bytes32"},{internalType:"uint64",name:"minAmountOut",type:"uint64"},{internalType:"uint64",name:"deadline",type:"uint64"},{internalType:"uint64",name:"redeemFee",type:"uint64"},{internalType:"bytes32",name:"referrerAddr",type:"bytes32"},{internalType:"uint8",name:"referrerBps",type:"uint8"}],internalType:"struct MayanCircle.OrderParams",name:"orderParams",type:"tuple"},{components:[{internalType:"bytes32",name:"trader",type:"bytes32"},{internalType:"uint16",name:"sourceChainId",type:"uint16"},{internalType:"uint8",name:"protocolBps",type:"uint8"}],internalType:"struct MayanCircle.ExtraParams",name:"extraParams",type:"tuple"}],name:"refund",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"uint256",name:"amount",type:"uint256"},{internalType:"address payable",name:"to",type:"address"}],name:"rescueEth",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"token",type:"address"},{internalType:"uint256",name:"amount",type:"uint256"},{internalType:"address",name:"to",type:"address"}],name:"rescueToken",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint8",name:"_consistencyLevel",type:"uint8"}],name:"setConsistencyLevel",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint16",name:"chainId",type:"uint16"},{internalType:"uint32",name:"domain",type:"uint32"}],name:"setDomain",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint32",name:"domain",type:"uint32"},{internalType:"bytes32",name:"caller",type:"bytes32"}],name:"setDomainCaller",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint16",name:"chainId",type:"uint16"},{internalType:"bytes32",name:"emitter",type:"bytes32"}],name:"setEmitter",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"_feeManager",type:"address"}],name:"setFeeManager",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint32",name:"destDomain",type:"uint32"},{internalType:"address",name:"tokenIn",type:"address"},{internalType:"bytes32",name:"mintRecipient",type:"bytes32"}],name:"setMintRecipient",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bool",name:"_pause",type:"bool"}],name:"setPause",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes",name:"encodedVm",type:"bytes"},{components:[{internalType:"uint8",name:"action",type:"uint8"},{internalType:"uint8",name:"payloadType",type:"uint8"},{internalType:"uint64",name:"cctpNonce",type:"uint64"},{internalType:"uint32",name:"cctpDomain",type:"uint32"},{internalType:"bytes32",name:"unlockerAddr",type:"bytes32"},{internalType:"uint64",name:"gasDrop",type:"uint64"}],internalType:"struct MayanCircle.UnlockFeeMsg",name:"unlockMsg",type:"tuple"}],name:"unlockFee",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes",name:"encodedVm1",type:"bytes"},{internalType:"bytes",name:"encodedVm2",type:"bytes"},{components:[{internalType:"uint8",name:"action",type:"uint8"},{internalType:"uint8",name:"payloadType",type:"uint8"},{internalType:"uint64",name:"cctpNonce",type:"uint64"},{internalType:"uint32",name:"cctpDomain",type:"uint32"},{internalType:"bytes32",name:"unlockerAddr",type:"bytes32"},{internalType:"uint64",name:"gasDrop",type:"uint64"}],internalType:"struct MayanCircle.UnlockFeeMsg",name:"unlockMsg",type:"tuple"},{components:[{internalType:"uint8",name:"action",type:"uint8"},{internalType:"uint8",name:"payloadType",type:"uint8"},{internalType:"uint64",name:"cctpNonce",type:"uint64"},{internalType:"uint32",name:"cctpDomain",type:"uint32"},{internalType:"bytes32",name:"unlockerAddr",type:"bytes32"},{internalType:"uint64",name:"gasDrop",type:"uint64"},{internalType:"bytes32",name:"destAddr",type:"bytes32"}],internalType:"struct MayanCircle.UnlockRefinedFeeMsg",name:"refinedMsg",type:"tuple"}],name:"unlockFeeRefined",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"wormhole",outputs:[{internalType:"contract IWormhole",name:"",type:"address"}],stateMutability:"view",type:"function"},{stateMutability:"payable",type:"receive"}],linkReferences:{},deployedLinkReferences:{}};import{PublicKey as ee}from"@solana/web3.js";var L=6;function me(e){switch(e){case"ethereum":return 0;case"avalanche":return 1;case"optimism":return 2;case"arbitrum":return 3;case"solana":return 5;case"base":return 6;case"polygon":return 7;case"sui":return 8;case"unichain":return 10;case"linea":return 11;default:throw new Error("unsupported chain for cctp")}}function _e(e,t){let n=new ee(d.CCTP_CORE_PROGRAM_ID),a=new ee(d.CCTP_TOKEN_PROGRAM_ID),[i]=ee.findProgramAddressSync([Buffer.from("message_transmitter")],n),[o]=ee.findProgramAddressSync([Buffer.from("sender_authority")],a),[s]=ee.findProgramAddressSync([Buffer.from("local_token"),e.toBytes()],a),[r]=ee.findProgramAddressSync([Buffer.from("token_messenger")],a),[c]=ee.findProgramAddressSync([Buffer.from("token_minter")],a),u=me(t),[l]=ee.findProgramAddressSync([Buffer.from("remote_token_messenger"),Buffer.from(u.toString())],a),[p]=ee.findProgramAddressSync([Buffer.from("__event_authority")],n),[y]=ee.findProgramAddressSync([Buffer.from("__event_authority")],a);return{messageTransmitter:i,senderAuthority:o,remoteTokenMessengerKey:l,tokenMessenger:r,tokenMinter:c,eventAuthToken:y,eventAuthCore:p,localToken:s}}function Vn(e,t,n,a){let i=H(Number(n)),o=k(e.fromChain),s=k(e.toChain);if(o!==i)throw new Error(`Signer chain id(${Number(n)}) and quote from chain are not same! ${o} !== ${i}`);let r=e.cheaperChain===e.fromChain;if(r&&a)throw new Error("Bridge lock fee cannot have custom payload");let c=A(t,s),u=w(e.redeemRelayerFee,L),l=w(e.gasDrop,Math.min(B(e.toChain),8)),p=BigInt(e.effectiveAmountIn64),y=me(e.toChain);if(!e.mctpMayanContract)throw new Error("MCTP contract address is missing");let m=e.mctpMayanContract;if(e.toChain==="solana"&&r)throw new Error("Cannot lock fee for transfer to solana");let f=w(e.bridgeFee,B(e.fromChain));return r&&(f=BigInt(0)),{lockFee:r,tokenIn:e.mctpInputContract,amountIn:p,redeemFee:u,gasDrop:l,destAddr:c,destDomain:y,payloadType:a?gt:Tt,customPayload:a?`0x${Buffer.from(a).toString("hex")}`:"0x",bridgeFee:f,contractAddress:m}}function kt(e,t,n,a){let i=Vn(e,t,n,a),{contractAddress:o,tokenIn:s,amountIn:r,destAddr:c,lockFee:u,redeemFee:l,gasDrop:p,destDomain:y,customPayload:m,payloadType:f,bridgeFee:b}=i,T=new Ze(o,Je.abi),h,g;return u?h=T.interface.encodeFunctionData("bridgeWithLockedFee",[s,r,p,l,y,c]):h=T.interface.encodeFunctionData("bridgeWithFee",[s,r,l,p,c,y,f,m]),g=j(b),{to:o,data:h,value:g,_params:i}}function Yn(e,t,n,a){let i=H(Number(a)),o=k(e.fromChain),s=k(e.toChain);if(o!==i)throw new Error(`Signer chain id(${Number(a)}) and quote from chain are not same! ${o} !== ${i}`);if(!e.mctpMayanContract)throw new Error("MCTP contract address is missing");let r=e.mctpMayanContract,c=A(t,s),u;n?u=A(n,s):u=A(Ct.programId.toString(),k("solana"));let l=w(e.redeemRelayerFee,L),p=w(e.gasDrop,Math.min(B(e.toChain),8)),y=BigInt(e.effectiveAmountIn64),m=w(e.minAmountOut,Math.min(8,e.toToken.decimals)),f=BigInt(e.deadline64),b=e.toToken.contract===je?A(Ct.programId.toString(),k("solana")):A(e.toChain==="sui"?e.toToken.verifiedAddress:e.toToken.contract,e.toToken.wChainId);return{params:{tokenIn:e.mctpInputContract,amountIn:y,gasDrop:p,destAddr:c,destChain:s,tokenOut:b,minAmountOut:m,deadline:f,redeemFee:l,referrerAddr:u,referrerBps:e.referrerBps||0},bridgeFee:w(e.bridgeFee,B(e.fromChain)),contractAddress:r}}function Rt(e,t,n,a){let i=Yn(e,t,n,a),{contractAddress:o,params:s,bridgeFee:r}=i,u=new Ze(o,Je.abi).interface.encodeFunctionData("createOrder",[s]),l=j(r);return{to:o,data:u,value:l,_params:i}}function _t(e,t,n,a,i,o){if(e.type!=="MCTP")throw new Error("Quote type is not MCTP");if(!Number.isFinite(Number(a)))throw new Error("Invalid signer chain id");a=Number(a);let s=i||X,r=new Ze(d.MAYAN_FORWARDER_CONTRACT,q.abi),c=w(e.bridgeFee,B(e.fromChain)),u=j(c);if(e.fromToken.contract===e.mctpInputContract)if(e.hasAuction){if(!Number(e.deadline64))throw new Error("MCTP order requires timeout");let l=Rt(e,t,n,a),p="forwardERC20",y=[e.fromToken.contract,l._params.params.amountIn,s,l._params.contractAddress,l.data];return{data:r.interface.encodeFunctionData(p,y),to:d.MAYAN_FORWARDER_CONTRACT,value:j(u),chainId:a,_forwarder:{method:p,params:y}}}else{let l=kt(e,t,a,o),p="forwardERC20",y=[e.fromToken.contract,l._params.amountIn,s,l._params.contractAddress,l.data];return{data:r.interface.encodeFunctionData(p,y),to:d.MAYAN_FORWARDER_CONTRACT,value:j(u),chainId:a,_forwarder:{method:p,params:y}}}else{let{minMiddleAmount:l,evmSwapRouterAddress:p,evmSwapRouterCalldata:y}=e;if(!l||!p||!y)throw new Error("MCTP swap requires middle amount, router address and calldata");if(e.hasAuction){if(!Number(e.deadline64))throw new Error("MCTP order requires timeout");let m=Rt(e,t,n,a),f=w(e.minMiddleAmount,L);if(e.fromToken.contract===je){let b=m._params.params.amountIn;if(b<=c)throw new Error("Amount in is less than bridge fee");c!==BigInt(0)&&(b-=c),u=j(m._params.params.amountIn);let T="swapAndForwardEth",h=[b,p,y,e.mctpInputContract,f,m._params.contractAddress,m.data];return{data:r.interface.encodeFunctionData(T,h),to:d.MAYAN_FORWARDER_CONTRACT,value:j(u),chainId:a,_forwarder:{method:T,params:h}}}else{let b="swapAndForwardERC20",T=[e.fromToken.contract,m._params.params.amountIn,s,p,y,e.mctpInputContract,f,m._params.contractAddress,m.data];return{data:r.interface.encodeFunctionData(b,T),to:d.MAYAN_FORWARDER_CONTRACT,value:j(u),chainId:a,_forwarder:{method:b,params:T}}}}else{let m=kt(e,t,a,o),f=w(e.minMiddleAmount,L);if(e.fromToken.contract===je){let b=m._params.amountIn;if(b<=c)throw new Error("Amount in is less than bridge fee");c!==BigInt(0)&&(b-=c),u=j(m._params.amountIn);let T="swapAndForwardEth",h=[b,p,y,e.mctpInputContract,f,m._params.contractAddress,m.data];return{data:r.interface.encodeFunctionData(T,h),to:d.MAYAN_FORWARDER_CONTRACT,value:j(u),chainId:a,_forwarder:{method:T,params:h}}}else{let b="swapAndForwardERC20",T=[e.fromToken.contract,m._params.amountIn,s,p,y,e.mctpInputContract,f,m._params.contractAddress,m.data];return{data:r.interface.encodeFunctionData(b,T),to:d.MAYAN_FORWARDER_CONTRACT,value:j(u),chainId:a,_forwarder:{method:b,params:T}}}}}}import{Contract as yn,toBeHex as Ue,ZeroAddress as Ge}from"ethers";import{Keypair as Ma,SystemProgram as dn}from"@solana/web3.js";var Et={_format:"hh-sol-artifact-1",contractName:"MayanSwift",sourceName:"src/MayanSwift.sol",abi:[{inputs:[{internalType:"address",name:"_wormhole",type:"address"},{internalType:"address",name:"_feeManager",type:"address"},{internalType:"uint16",name:"_auctionChainId",type:"uint16"},{internalType:"bytes32",name:"_auctionAddr",type:"bytes32"},{internalType:"bytes32",name:"_solanaEmitter",type:"bytes32"},{internalType:"uint8",name:"_consistencyLevel",type:"uint8"}],stateMutability:"nonpayable",type:"constructor"},{inputs:[],name:"DeadlineViolation",type:"error"},{inputs:[],name:"DuplicateOrder",type:"error"},{inputs:[],name:"FeesTooHigh",type:"error"},{inputs:[],name:"InvalidAction",type:"error"},{inputs:[],name:"InvalidAmount",type:"error"},{inputs:[],name:"InvalidAuctionMode",type:"error"},{inputs:[],name:"InvalidBpsFee",type:"error"},{inputs:[],name:"InvalidContractSignature",type:"error"},{inputs:[],name:"InvalidDestChain",type:"error"},{inputs:[],name:"InvalidEmitterAddress",type:"error"},{inputs:[],name:"InvalidEmitterChain",type:"error"},{inputs:[],name:"InvalidEvmAddr",type:"error"},{inputs:[],name:"InvalidGasDrop",type:"error"},{inputs:[],name:"InvalidOrderHash",type:"error"},{inputs:[],name:"InvalidOrderStatus",type:"error"},{inputs:[],name:"InvalidSignature",type:"error"},{inputs:[],name:"InvalidSignatureLength",type:"error"},{inputs:[],name:"InvalidSigner",type:"error"},{inputs:[],name:"InvalidSrcChain",type:"error"},{inputs:[],name:"InvalidWormholeFee",type:"error"},{inputs:[],name:"OrderNotExists",type:"error"},{inputs:[],name:"Paused",type:"error"},{inputs:[],name:"SmallAmountIn",type:"error"},{inputs:[],name:"Unauthorized",type:"error"},{anonymous:!1,inputs:[{indexed:!1,internalType:"bytes32",name:"key",type:"bytes32"},{indexed:!1,internalType:"uint64",name:"sequence",type:"uint64"}],name:"OrderCanceled",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"bytes32",name:"key",type:"bytes32"}],name:"OrderCreated",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"bytes32",name:"key",type:"bytes32"},{indexed:!1,internalType:"uint64",name:"sequence",type:"uint64"},{indexed:!1,internalType:"uint256",name:"netAmount",type:"uint256"}],name:"OrderFulfilled",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"bytes32",name:"key",type:"bytes32"},{indexed:!1,internalType:"uint256",name:"netAmount",type:"uint256"}],name:"OrderRefunded",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"bytes32",name:"key",type:"bytes32"}],name:"OrderUnlocked",type:"event"},{inputs:[],name:"auctionAddr",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[],name:"auctionChainId",outputs:[{internalType:"uint16",name:"",type:"uint16"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32",name:"tokenIn",type:"bytes32"},{components:[{internalType:"bytes32",name:"trader",type:"bytes32"},{internalType:"bytes32",name:"tokenOut",type:"bytes32"},{internalType:"uint64",name:"minAmountOut",type:"uint64"},{internalType:"uint64",name:"gasDrop",type:"uint64"},{internalType:"uint64",name:"cancelFee",type:"uint64"},{internalType:"uint64",name:"refundFee",type:"uint64"},{internalType:"uint64",name:"deadline",type:"uint64"},{internalType:"bytes32",name:"destAddr",type:"bytes32"},{internalType:"uint16",name:"destChainId",type:"uint16"},{internalType:"bytes32",name:"referrerAddr",type:"bytes32"},{internalType:"uint8",name:"referrerBps",type:"uint8"},{internalType:"uint8",name:"auctionMode",type:"uint8"},{internalType:"bytes32",name:"random",type:"bytes32"}],internalType:"struct MayanSwift.OrderParams",name:"params",type:"tuple"},{internalType:"uint16",name:"srcChainId",type:"uint16"},{internalType:"uint8",name:"protocolBps",type:"uint8"},{internalType:"bytes32",name:"canceler",type:"bytes32"}],name:"cancelOrder",outputs:[{internalType:"uint64",name:"sequence",type:"uint64"}],stateMutability:"payable",type:"function"},{inputs:[{internalType:"address",name:"newGuardian",type:"address"}],name:"changeGuardian",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"claimGuardian",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"consistencyLevel",outputs:[{internalType:"uint8",name:"",type:"uint8"}],stateMutability:"view",type:"function"},{inputs:[{components:[{internalType:"bytes32",name:"trader",type:"bytes32"},{internalType:"bytes32",name:"tokenOut",type:"bytes32"},{internalType:"uint64",name:"minAmountOut",type:"uint64"},{internalType:"uint64",name:"gasDrop",type:"uint64"},{internalType:"uint64",name:"cancelFee",type:"uint64"},{internalType:"uint64",name:"refundFee",type:"uint64"},{internalType:"uint64",name:"deadline",type:"uint64"},{internalType:"bytes32",name:"destAddr",type:"bytes32"},{internalType:"uint16",name:"destChainId",type:"uint16"},{internalType:"bytes32",name:"referrerAddr",type:"bytes32"},{internalType:"uint8",name:"referrerBps",type:"uint8"},{internalType:"uint8",name:"auctionMode",type:"uint8"},{internalType:"bytes32",name:"random",type:"bytes32"}],internalType:"struct MayanSwift.OrderParams",name:"params",type:"tuple"}],name:"createOrderWithEth",outputs:[{internalType:"bytes32",name:"orderHash",type:"bytes32"}],stateMutability:"payable",type:"function"},{inputs:[{internalType:"address",name:"tokenIn",type:"address"},{internalType:"uint256",name:"amountIn",type:"uint256"},{components:[{internalType:"bytes32",name:"trader",type:"bytes32"},{internalType:"bytes32",name:"tokenOut",type:"bytes32"},{internalType:"uint64",name:"minAmountOut",type:"uint64"},{internalType:"uint64",name:"gasDrop",type:"uint64"},{internalType:"uint64",name:"cancelFee",type:"uint64"},{internalType:"uint64",name:"refundFee",type:"uint64"},{internalType:"uint64",name:"deadline",type:"uint64"},{internalType:"bytes32",name:"destAddr",type:"bytes32"},{internalType:"uint16",name:"destChainId",type:"uint16"},{internalType:"bytes32",name:"referrerAddr",type:"bytes32"},{internalType:"uint8",name:"referrerBps",type:"uint8"},{internalType:"uint8",name:"auctionMode",type:"uint8"},{internalType:"bytes32",name:"random",type:"bytes32"}],internalType:"struct MayanSwift.OrderParams",name:"params",type:"tuple"},{internalType:"bytes",name:"signedOrderHash",type:"bytes"}],name:"createOrderWithSig",outputs:[{internalType:"bytes32",name:"orderHash",type:"bytes32"}],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"tokenIn",type:"address"},{internalType:"uint256",name:"amountIn",type:"uint256"},{components:[{internalType:"bytes32",name:"trader",type:"bytes32"},{internalType:"bytes32",name:"tokenOut",type:"bytes32"},{internalType:"uint64",name:"minAmountOut",type:"uint64"},{internalType:"uint64",name:"gasDrop",type:"uint64"},{internalType:"uint64",name:"cancelFee",type:"uint64"},{internalType:"uint64",name:"refundFee",type:"uint64"},{internalType:"uint64",name:"deadline",type:"uint64"},{internalType:"bytes32",name:"destAddr",type:"bytes32"},{internalType:"uint16",name:"destChainId",type:"uint16"},{internalType:"bytes32",name:"referrerAddr",type:"bytes32"},{internalType:"uint8",name:"referrerBps",type:"uint8"},{internalType:"uint8",name:"auctionMode",type:"uint8"},{internalType:"bytes32",name:"random",type:"bytes32"}],internalType:"struct MayanSwift.OrderParams",name:"params",type:"tuple"}],name:"createOrderWithToken",outputs:[{internalType:"bytes32",name:"orderHash",type:"bytes32"}],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"feeManager",outputs:[{internalType:"contract IFeeManager",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"fulfillAmount",type:"uint256"},{internalType:"bytes",name:"encodedVm",type:"bytes"},{internalType:"bytes32",name:"recepient",type:"bytes32"},{internalType:"bool",name:"batch",type:"bool"}],name:"fulfillOrder",outputs:[{internalType:"uint64",name:"sequence",type:"uint64"}],stateMutability:"payable",type:"function"},{inputs:[{internalType:"uint256",name:"fulfillAmount",type:"uint256"},{internalType:"bytes32",name:"orderHash",type:"bytes32"},{internalType:"uint16",name:"srcChainId",type:"uint16"},{internalType:"bytes32",name:"tokenIn",type:"bytes32"},{internalType:"uint8",name:"protocolBps",type:"uint8"},{components:[{internalType:"bytes32",name:"trader",type:"bytes32"},{internalType:"bytes32",name:"tokenOut",type:"bytes32"},{internalType:"uint64",name:"minAmountOut",type:"uint64"},{internalType:"uint64",name:"gasDrop",type:"uint64"},{internalType:"uint64",name:"cancelFee",type:"uint64"},{internalType:"uint64",name:"refundFee",type:"uint64"},{internalType:"uint64",name:"deadline",type:"uint64"},{internalType:"bytes32",name:"destAddr",type:"bytes32"},{internalType:"uint16",name:"destChainId",type:"uint16"},{internalType:"bytes32",name:"referrerAddr",type:"bytes32"},{internalType:"uint8",name:"referrerBps",type:"uint8"},{internalType:"uint8",name:"auctionMode",type:"uint8"},{internalType:"bytes32",name:"random",type:"bytes32"}],internalType:"struct MayanSwift.OrderParams",name:"params",type:"tuple"},{internalType:"bytes32",name:"recepient",type:"bytes32"},{internalType:"bool",name:"batch",type:"bool"}],name:"fulfillSimple",outputs:[{internalType:"uint64",name:"sequence",type:"uint64"}],stateMutability:"payable",type:"function"},{inputs:[],name:"guardian",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"nextGuardian",outputs:[{internalType:"address",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32",name:"",type:"bytes32"}],name:"orders",outputs:[{internalType:"enum MayanSwift.Status",name:"status",type:"uint8"},{internalType:"uint64",name:"amountIn",type:"uint64"},{internalType:"uint16",name:"destChainId",type:"uint16"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes",name:"encoded",type:"bytes"}],name:"parseFulfillPayload",outputs:[{components:[{internalType:"uint8",name:"action",type:"uint8"},{internalType:"bytes32",name:"orderHash",type:"bytes32"},{internalType:"uint16",name:"destChainId",type:"uint16"},{internalType:"bytes32",name:"destAddr",type:"bytes32"},{internalType:"bytes32",name:"driver",type:"bytes32"},{internalType:"bytes32",name:"tokenOut",type:"bytes32"},{internalType:"uint64",name:"promisedAmount",type:"uint64"},{internalType:"uint64",name:"gasDrop",type:"uint64"},{internalType:"uint64",name:"deadline",type:"uint64"},{internalType:"bytes32",name:"referrerAddr",type:"bytes32"},{internalType:"uint8",name:"referrerBps",type:"uint8"},{internalType:"uint8",name:"protocolBps",type:"uint8"},{internalType:"uint16",name:"srcChainId",type:"uint16"},{internalType:"bytes32",name:"tokenIn",type:"bytes32"}],internalType:"struct MayanSwift.FulfillMsg",name:"fulfillMsg",type:"tuple"}],stateMutability:"pure",type:"function"},{inputs:[{internalType:"bytes",name:"encoded",type:"bytes"}],name:"parseRefundPayload",outputs:[{components:[{internalType:"uint8",name:"action",type:"uint8"},{internalType:"bytes32",name:"orderHash",type:"bytes32"},{internalType:"uint16",name:"srcChainId",type:"uint16"},{internalType:"bytes32",name:"tokenIn",type:"bytes32"},{internalType:"bytes32",name:"recipient",type:"bytes32"},{internalType:"bytes32",name:"canceler",type:"bytes32"},{internalType:"uint64",name:"cancelFee",type:"uint64"},{internalType:"uint64",name:"refundFee",type:"uint64"}],internalType:"struct MayanSwift.RefundMsg",name:"refundMsg",type:"tuple"}],stateMutability:"pure",type:"function"},{inputs:[{internalType:"bytes",name:"encoded",type:"bytes"}],name:"parseUnlockPayload",outputs:[{components:[{internalType:"uint8",name:"action",type:"uint8"},{internalType:"bytes32",name:"orderHash",type:"bytes32"},{internalType:"uint16",name:"srcChainId",type:"uint16"},{internalType:"bytes32",name:"tokenIn",type:"bytes32"},{internalType:"bytes32",name:"recipient",type:"bytes32"}],internalType:"struct MayanSwift.UnlockMsg",name:"unlockMsg",type:"tuple"}],stateMutability:"pure",type:"function"},{inputs:[],name:"paused",outputs:[{internalType:"bool",name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes32[]",name:"orderHashes",type:"bytes32[]"}],name:"postBatch",outputs:[{internalType:"uint64",name:"sequence",type:"uint64"}],stateMutability:"payable",type:"function"},{inputs:[{internalType:"bytes",name:"encodedVm",type:"bytes"}],name:"refundOrder",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint8",name:"_consistencyLevel",type:"uint8"}],name:"setConsistencyLevel",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"address",name:"_feeManager",type:"address"}],name:"setFeeManager",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bool",name:"_pause",type:"bool"}],name:"setPause",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"solanaEmitter",outputs:[{internalType:"bytes32",name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes",name:"encodedVm",type:"bytes"}],name:"unlockBatch",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"bytes32",name:"",type:"bytes32"}],name:"unlockMsgs",outputs:[{internalType:"uint8",name:"action",type:"uint8"},{internalType:"bytes32",name:"orderHash",type:"bytes32"},{internalType:"uint16",name:"srcChainId",type:"uint16"},{internalType:"bytes32",name:"tokenIn",type:"bytes32"},{internalType:"bytes32",name:"recipient",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes",name:"encodedVm",type:"bytes"}],name:"unlockSingle",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"wormhole",outputs:[{internalType:"contract IWormhole",name:"",type:"address"}],stateMutability:"view",type:"function"},{stateMutability:"payable",type:"receive"}],linkReferences:{},deployedLinkReferences:{}};import{Connection as Oe,Keypair as $n,PublicKey as D,SystemProgram as ce,SYSVAR_RENT_PUBKEY as Nt,Transaction as Xe,TransactionInstruction as ie,AddressLookupTableAccount as Ot,ComputeBudgetProgram as zn}from"@solana/web3.js";import{Buffer as se}from"buffer";import{blob as Wt,struct as Fe,u8 as De}from"@solana/buffer-layout";import{encodeBase58 as Jn,sha256 as jn,toUtf8Bytes as Zn}from"ethers";var Xn={};function qn(e){return Xn[e]??=new Oe(e),new Oe(e)}async function xe({trx:e,connection:t,errorChance:n,extraRpcs:a,options:i,rate:o=8}){let s=null,r=0,c=[t].concat(a.map(qn));for(let u=0;u<o;u++){if(s)try{let p=await Promise.any(c.map(y=>y.getSignatureStatus(s)));if(p&&p.value){if(p.value.err){if(r>=n)return{signature:s,serializedTrx:e};r++}else if(p.value.confirmationStatus==="confirmed")return{signature:s,serializedTrx:e}}}catch(p){console.error(p)}let l=c.map(p=>p.sendRawTransaction(e,i));if(!s)try{s=await Promise.any(l)}catch(p){console.error("Transaction not submitted, remaining attempts:",o-u-1,p)}await ke(1e3)}if(!s)throw new Error("Failed to send transaction");return{signature:s,serializedTrx:e}}function $(e,t,n,a,i=new D(d.TOKEN_PROGRAM_ID),o=new D(d.ASSOCIATED_TOKEN_PROGRAM_ID)){let s=[{pubkey:e,isSigner:!0,isWritable:!0},{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!1,isWritable:!1},{pubkey:a,isSigner:!1,isWritable:!1},{pubkey:ce.programId,isSigner:!1,isWritable:!1},{pubkey:i,isSigner:!1,isWritable:!1},{pubkey:Nt,isSigner:!1,isWritable:!1}];return new ie({keys:s,programId:o,data:se.alloc(0)})}var Ft=165;async function Be(e,t,n,a,i,o=new D(d.TOKEN_PROGRAM_ID)){let s=[],r=await e.getMinimumBalanceForRentExemption(Ft);return s.push(ce.createAccount({fromPubkey:t,newAccountPubkey:i.publicKey,lamports:r,space:Ft,programId:o})),s.push(new ie({keys:[{pubkey:i.publicKey,isWritable:!0,isSigner:!1},{pubkey:n,isWritable:!1,isSigner:!1},{pubkey:a,isWritable:!1,isSigner:!1},{pubkey:Nt,isWritable:!1,isSigner:!1}],programId:o,data:se.from([1])})),s}var Dt=Fe([De("instruction"),Wt(8,"amount")]);function Kt(e,t,n,a,i=new D(d.TOKEN_PROGRAM_ID)){let o=[{pubkey:e,isSigner:!1,isWritable:!0},{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!0,isWritable:!1}],s=se.alloc(Dt.span);return Dt.encode({instruction:4,amount:_(a)},s),new ie({keys:o,programId:i,data:s})}var xt=Fe([De("instruction")]);function Ie(e){let t=[{pubkey:e,isSigner:!1,isWritable:!0}],n=se.alloc(xt.span);return xt.encode({instruction:17},n),new ie({keys:t,programId:new D(d.TOKEN_PROGRAM_ID),data:n})}var Bt=Fe([De("instruction")]);function ea(e,t,n,a=new D(d.TOKEN_PROGRAM_ID)){let i=[{pubkey:e,isSigner:!1,isWritable:!0},{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!0,isWritable:!1}],o=se.alloc(Bt.span);return Bt.encode({instruction:9},o),new ie({keys:i,programId:a,data:o})}var vt=Fe([De("instruction"),Wt(8,"amount")]);function Me(e,t,n,a,i=new D(d.TOKEN_PROGRAM_ID)){let o=[{pubkey:e,isSigner:!1,isWritable:!0},{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!0,isWritable:!1}],s=se.alloc(vt.span);return vt.encode({instruction:3,amount:_(a)},s),new ie({keys:o,programId:i,data:s})}var te=new D("So11111111111111111111111111111111111111112");async function gr(e,t,n,a){let i=a??new Oe("https://rpc.ankr.com/solana"),o=F(te,e,!1),{blockhash:s,lastValidBlockHeight:r}=await i.getLatestBlockhash(),c=new Xe({feePayer:e,blockhash:s,lastValidBlockHeight:r}),u=await i.getAccountInfo(o,"finalized");(!u||u.data.length===0)&&c.add($(e,o,e,te)),c.add(ce.transfer({fromPubkey:e,toPubkey:o,lamports:w(t,9)})),c.add(Ie(o));let l=await n(c);return await xe({trx:l.serialize(),connection:i,errorChance:1,extraRpcs:[]})}async function wr(e,t,n,a){let i=a??new Oe("https://rpc.ankr.com/solana"),o=F(te,e,!1),s=$n.generate(),{blockhash:r,lastValidBlockHeight:c}=await i.getLatestBlockhash(),u=new Xe({feePayer:e,blockhash:r,lastValidBlockHeight:c}),l=F(te,s.publicKey,!1);u.add($(e,l,s.publicKey,te)),u.add(Me(o,l,e,w(t,9))),u.add(ea(l,e,s.publicKey)),u.partialSign(s);let p=await n(u);return await xe({trx:p.serialize(),connection:i,errorChance:1,extraRpcs:[]})}function Ee(e){return new ie({programId:new D(e.programId),keys:e.accounts.map(t=>({pubkey:new D(t.pubkey),isSigner:t.isSigner,isWritable:t.isWritable})),data:se.from(e.data,"base64")})}async function ve(e,t){return(await t.getMultipleAccountsInfo(e.map(a=>new D(a)))).reduce((a,i,o)=>{let s=e[o];if(i){let r=new Ot({key:new D(s),state:Ot.deserialize(i.data)});a.push(r)}return a},new Array)}function Ne(e,t){let n=Ee(e.swapInstruction),a=e.cleanupInstruction?Ee(e.cleanupInstruction):null,i=e.computeBudgetInstructions?e.computeBudgetInstructions.map(Ee):[],o=e.setupInstructions?e.setupInstructions.map(Ee):[];return{swapInstruction:n,cleanupInstruction:a,computeBudgetInstructions:i,setupInstructions:o,addressLookupTableAddresses:e.addressLookupTableAddresses}}function Z(e){let t=`global:${e}`;return se.from(jn(Zn(t))).subarray(0,8)}async function Lt(){let e;try{let t=await It();e=new D(t)}catch{console.log("Relayer not found, using system program"),e=ce.programId}return e}function Ut(e,t,n,a){let i=a.jitoAccount||"Cw8CFyM9FkoMi7K7Crf6HNQqf4uEMzpKw6QNghXLvLkY";return new Xe({feePayer:new D(e),blockhash:t,lastValidBlockHeight:n}).add(ce.transfer({fromPubkey:new D(e),toPubkey:new D(i),lamports:a.tipLamports}))}async function qe(e,t,n=!1){try{let a=[];for(let s of e)a.push(s.serialize());let i={jsonrpc:"2.0",id:1,method:"sendBundle",params:[a.map(s=>Jn(s))]},o=await fetch(t.jitoSendUrl||"https://mainnet.block-engine.jito.wtf/api/v1/bundles",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)});if(o.status!==200&&o.status!==201)throw new Error("Send Jito bundle failed");return(await o.json()).result}catch(a){if(console.error("Send Jito bundle failed",a),n)throw a}}async function ta(e,t){let a=0;for(;a<5;)try{let i=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({jsonrpc:"2.0",id:1,method:"getBundleStatuses",params:[e]})});if(!i.ok)throw new Error(`HTTP error! Status: ${i.status}`);let o=await i.json();if(o.error)throw new Error(`Error getting bundle statuses: ${JSON.stringify(o.error,null,2)}`);return o.result}catch(i){if(a++,await ke(400),a>=5)throw new Error(`Failed to fetch bundle statuses after 5 attempts: ${i.message}`)}}async function Gt(e,t,n,a,i){let s=Date.now();for(;Date.now()-s<9e4&&await i.getBlockHeight()<=n;){await ke(350);let r=await ta([e],t.jitoSendUrl||"https://mainnet.block-engine.jito.wtf/api/v1/bundles");if(r&&r.value&&r.value.length>0&&r.value[0]){console.log("===>",r.value[0]);let c=r.value[0].confirmation_status;if(c==="confirmed"||c==="finalized"){let u=await i.getSignatureStatus(a);if(!u||!u.value)continue;if(u.value?.err)throw new Error(`Bundle failed with error: ${u.value.err}`);return}}}throw new Error("Bundle not confirmed, timeout")}async function Ht(e){try{await fetch("https://explorer-api.mayan.finance/v3/submit/jito-bundle",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({bundleId:e})})}catch{}}function na(e){if(e){if(!e.programId.equals(new D(d.TOKEN_PROGRAM_ID))&&!e.programId.equals(new D(d.TOKEN_2022_PROGRAM_ID)))throw new Error("Invalid cleanup instruction:: programId");if(Uint8Array.from(e.data).length!==1)throw new Error("Invalid cleanup instruction:: data");if(Uint8Array.from(e.data)[0]!==9)throw new Error("Invalid cleanup instruction:: data")}}function aa(e,t){if(!(e.length<1)){if(e.length>6)throw new Error("Invalid setup instruction:: too many instructions");e.forEach(n=>{if(!n.programId.equals(new D(d.ASSOCIATED_TOKEN_PROGRAM_ID))&&!n.programId.equals(ce.programId)&&!n.programId.equals(new D(d.TOKEN_PROGRAM_ID))&&!n.programId.equals(new D(d.TOKEN_2022_PROGRAM_ID)))throw new Error("Invalid setup instruction:: programId");if(n.programId.equals(new D(d.ASSOCIATED_TOKEN_PROGRAM_ID))){if(Uint8Array.from(n.data).length===1){if(Uint8Array.from(n.data)[0]!==1)throw new Error("Invalid setup instruction:: data")}else if(Uint8Array.from(n.data).length!==0)throw new Error("Invalid setup instruction:: data")}else if(n.programId.equals(ce.programId)){if(!t)throw new Error("Invalid setup instruction:: unknown transfer");let a=F(te,t,!0);if(n.data.readUint32LE()!==2)throw new Error("Invalid setup instruction:: invalid system program instruction");if(!n.keys[1].pubkey.equals(a))throw new Error("Invalid setup instruction:: invalid wrap transfer dest")}else if(n.data.toString("base64")!=="EQ==")throw new Error("Invalid setup instruction:: invalid token program instruction")})}}function ra(e,t){if(!e.programId.equals(new D("JUP6LkbZbjS1jKKwapdHNy74zcZ3tLUZoi5QNyVTaV4")))throw new Error("Invalid swap instruction:: programId");if(e.data.subarray(0,8).toString("hex")===Z("shared_accounts_route").toString("hex")){if(!e.keys[6].pubkey.equals(t))throw new Error("Invalid swap instruction shared_accounts_route:: dest account")}else if(e.data.subarray(0,8).toString("hex")===Z("route").toString("hex")){if(!e.keys[4].pubkey.equals(t))throw new Error("Invalid swap instruction route:: dest account")}else throw new Error("Invalid swap instruction:: ix id")}function ia(e){e.forEach(t=>{if(!t.programId.equals(zn.programId))throw new Error("Invalid compute budget instruction:: programId");if(Uint8Array.from(t.data)[0]===3&&t.data.readBigUInt64LE(1)>100000000n)throw new Error("Invalid compute budget instruction:: to high tx fee")})}function Se(e,t,n){ia(e.computeBudgetInstructions),aa(e.setupInstructions,n),ra(e.swapInstruction,t),na(e.cleanupInstruction)}function We(e,t,n,a,i,o=new D("TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA")){return new ie({keys:[{pubkey:e,isSigner:!0,isWritable:!1},{pubkey:n,isSigner:!1,isWritable:!0},{pubkey:a,isSigner:!1,isWritable:!0},{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:i,isSigner:!1,isWritable:!0},{pubkey:o,isSigner:!1,isWritable:!1}],programId:new D("B96dV3Luxzo6SokJx3xt8i5y8Mb7HRR6Eec8hCjJDT69"),data:Z("transfer_all_and_close")})}import{Connection as cn,PublicKey as Y,Keypair as nt,SystemProgram as Le,SYSVAR_CLOCK_PUBKEY as fa,SYSVAR_RENT_PUBKEY as ba,Transaction as on,TransactionInstruction as Ta,ComputeBudgetProgram as ga,MessageV0 as un,VersionedTransaction as at}from"@solana/web3.js";import{blob as oe,struct as wa,u16 as Aa,u8 as we}from"@solana/buffer-layout";import{Buffer as ue}from"buffer";import{encodeBase58 as pn,ZeroAddress as rt}from"ethers";import{PublicKey as M,Keypair as be,SystemProgram as ye,SYSVAR_CLOCK_PUBKEY as sa,SYSVAR_RENT_PUBKEY as oa,TransactionInstruction as Pe,ComputeBudgetProgram as ua}from"@solana/web3.js";import{blob as v,struct as Ce,u16 as tn,u8 as et}from"@solana/buffer-layout";import{Buffer as Q}from"buffer";import{PublicKey as fe}from"@solana/web3.js";function Qt(e){let t=new fe(d.WORMHOLE_PROGRAM_ID),n=new fe(e),[a]=fe.findProgramAddressSync([Buffer.from("Bridge")],t),[i]=fe.findProgramAddressSync([Buffer.from("emitter")],n),[o]=fe.findProgramAddressSync([Buffer.from("Sequence"),i.toBuffer()],t),[s]=fe.findProgramAddressSync([Buffer.from("fee_collector")],t);return{bridgeConfig:a,sequenceKey:o,feeCollector:s,emitter:i}}var Vt=Ce([v(8,"instruction")]);function Yt(e,t,n,a,i){let o=new M(d.WORMHOLE_PROGRAM_ID),s=new M(d.TOKEN_PROGRAM_ID),r=new M(d.CCTP_CORE_PROGRAM_ID),c=new M(d.CCTP_TOKEN_PROGRAM_ID),u=new M(d.MCTP_PROGRAM_ID),l=new M(a),p=new M(n),y=F(p,e,!0),m;i&&i>BigInt(0)?m=F(p,l,!1):m=new M(d.MCTP_PROGRAM_ID);let f=_e(p,t),b=Qt(d.MCTP_PROGRAM_ID),T=be.generate(),h=be.generate(),g=[{pubkey:e,isWritable:!0,isSigner:!1},{pubkey:y,isWritable:!0,isSigner:!1},{pubkey:l,isWritable:!0,isSigner:!0},{pubkey:m,isWritable:!0,isSigner:!1},{pubkey:p,isWritable:!0,isSigner:!1},{pubkey:f.senderAuthority,isWritable:!1,isSigner:!1},{pubkey:f.tokenMessenger,isWritable:!1,isSigner:!1},{pubkey:f.remoteTokenMessengerKey,isWritable:!1,isSigner:!1},{pubkey:f.tokenMinter,isWritable:!1,isSigner:!1},{pubkey:f.localToken,isWritable:!0,isSigner:!1},{pubkey:f.eventAuthToken,isWritable:!1,isSigner:!1},{pubkey:f.messageTransmitter,isWritable:!0,isSigner:!1},{pubkey:T.publicKey,isWritable:!0,isSigner:!0},{pubkey:c,isWritable:!1,isSigner:!1},{pubkey:r,isWritable:!1,isSigner:!1},{pubkey:b.emitter,isWritable:!1,isSigner:!1},{pubkey:b.bridgeConfig,isWritable:!0,isSigner:!1},{pubkey:b.sequenceKey,isWritable:!0,isSigner:!1},{pubkey:b.feeCollector,isWritable:!0,isSigner:!1},{pubkey:h.publicKey,isWritable:!0,isSigner:!0},{pubkey:o,isWritable:!1,isSigner:!1},{pubkey:sa,isWritable:!1,isSigner:!1},{pubkey:oa,isWritable:!1,isSigner:!1},{pubkey:s,isWritable:!1,isSigner:!1},{pubkey:ye.programId,isWritable:!1,isSigner:!1}],S=Q.alloc(Vt.span);return Vt.encode({instruction:Z("bridge_with_fee")},S),{instruction:new Pe({keys:g,data:S,programId:u}),signers:[T,h]}}var $t=Ce([v(8,"instruction")]);function zt(e,t,n,a,i){let o=[],s=new M(d.TOKEN_PROGRAM_ID),r=new M(d.ASSOCIATED_TOKEN_PROGRAM_ID),c=new M(d.CCTP_CORE_PROGRAM_ID),u=new M(d.CCTP_TOKEN_PROGRAM_ID),l=new M(d.MCTP_PROGRAM_ID),p=new M(a),y=new M(n),m=F(y,e,!0),f=_e(y,t),b=be.generate(),[T]=M.findProgramAddressSync([Q.from("LOCKED_FEE"),y.toBuffer(),b.publicKey.toBytes()],l),h;i&&i>BigInt(0)?h=F(y,p,!1):h=new M(d.MCTP_PROGRAM_ID);let g=F(y,T,!0);o.push($(p,g,T,y));let S=[{pubkey:e,isWritable:!0,isSigner:!1},{pubkey:m,isWritable:!0,isSigner:!1},{pubkey:p,isWritable:!0,isSigner:!0},{pubkey:h,isWritable:!0,isSigner:!1},{pubkey:T,isWritable:!0,isSigner:!1},{pubkey:g,isWritable:!0,isSigner:!1},{pubkey:y,isWritable:!0,isSigner:!1},{pubkey:f.senderAuthority,isWritable:!1,isSigner:!1},{pubkey:f.tokenMessenger,isWritable:!1,isSigner:!1},{pubkey:f.remoteTokenMessengerKey,isWritable:!1,isSigner:!1},{pubkey:f.tokenMinter,isWritable:!1,isSigner:!1},{pubkey:f.localToken,isWritable:!0,isSigner:!1},{pubkey:f.eventAuthToken,isWritable:!1,isSigner:!1},{pubkey:f.messageTransmitter,isWritable:!0,isSigner:!1},{pubkey:b.publicKey,isWritable:!0,isSigner:!0},{pubkey:u,isWritable:!1,isSigner:!1},{pubkey:c,isWritable:!1,isSigner:!1},{pubkey:s,isWritable:!1,isSigner:!1},{pubkey:r,isWritable:!1,isSigner:!1},{pubkey:ye.programId,isWritable:!1,isSigner:!1}],R=Q.alloc($t.span);$t.encode({instruction:Z("bridge_locked_fee")},R);let C=new Pe({keys:S,data:R,programId:l});return o.push(C),{instructions:o,signer:b}}var Jt=Ce([v(8,"instruction")]);function jt(e,t,n,a,i){let o=new M(d.TOKEN_PROGRAM_ID),s=new M(d.CCTP_CORE_PROGRAM_ID),r=new M(d.CCTP_TOKEN_PROGRAM_ID),c=new M(d.MCTP_PROGRAM_ID),u=new M(a),l=new M(n),p=F(l,e,!0),y=_e(l,t),m=be.generate(),[f]=M.findProgramAddressSync([Q.from("ORDER_SOLANA_SOURCE"),e.toBuffer()],c),b;i&&i>BigInt(0)?b=F(l,u,!1):b=new M(d.MCTP_PROGRAM_ID);let T=[{pubkey:e,isWritable:!1,isSigner:!1},{pubkey:p,isWritable:!0,isSigner:!1},{pubkey:u,isWritable:!0,isSigner:!0},{pubkey:b,isWritable:!0,isSigner:!1},{pubkey:l,isWritable:!0,isSigner:!1},{pubkey:f,isWritable:!0,isSigner:!1},{pubkey:y.senderAuthority,isWritable:!1,isSigner:!1},{pubkey:y.tokenMessenger,isWritable:!1,isSigner:!1},{pubkey:y.remoteTokenMessengerKey,isWritable:!1,isSigner:!1},{pubkey:y.tokenMinter,isWritable:!1,isSigner:!1},{pubkey:y.localToken,isWritable:!0,isSigner:!1},{pubkey:y.eventAuthToken,isWritable:!1,isSigner:!1},{pubkey:y.messageTransmitter,isWritable:!0,isSigner:!1},{pubkey:m.publicKey,isWritable:!0,isSigner:!0},{pubkey:r,isWritable:!1,isSigner:!1},{pubkey:s,isWritable:!1,isSigner:!1},{pubkey:new M(d.FEE_MANAGER_PROGRAM_ID),isWritable:!1,isSigner:!1},{pubkey:o,isWritable:!1,isSigner:!1},{pubkey:ye.programId,isWritable:!1,isSigner:!1}],h=Q.alloc(Jt.span);return Jt.encode({instruction:Z("create_order")},h),{instruction:new Pe({keys:T,data:h,programId:c}),signer:m}}var Zt=Ce([v(8,"instruction"),v(32,"destAddress"),v(8,"amountInMin"),v(8,"gasDrop"),v(8,"feeRedeem"),v(8,"feeSolana"),tn("destinationChain"),v(32,"keyRnd"),et("mode")]);function Xt(e){if(e.mode!=="WITH_FEE"&&e.mode!=="LOCK_FEE")throw new Error("Invalid mode: "+e.mode);let t=new M(e.swapperAddress),n=new M(e.mintAddress),a=F(n,e.ledger,!0),i=k(e.toChain),o=Q.from(N(A(e.destinationAddress,i))),s=_(e.amountInMin64),r=_(w(e.gasDrop,Math.min(B(e.toChain),8))),c=_(w(e.feeRedeem,L)),u=_(e.feeSolana),l=e.referrerAddress?Q.from(N(A(e.referrerAddress,i))):ye.programId.toBuffer(),p=[{pubkey:t,isWritable:!0,isSigner:!0},{pubkey:e.ledger,isWritable:!0,isSigner:!1},{pubkey:a,isWritable:!1,isSigner:!1},{pubkey:e.customPayload||new M(d.MCTP_PROGRAM_ID),isWritable:!1,isSigner:!1},{pubkey:n,isWritable:!1,isSigner:!1},{pubkey:ye.programId,isWritable:!1,isSigner:!1},{pubkey:new M(l),isWritable:!1,isSigner:!1}],y=Q.alloc(Zt.span);return Zt.encode({instruction:Z("init_bridge_ledger"),destAddress:o,amountInMin:s,gasDrop:r,feeRedeem:c,feeSolana:u,destinationChain:i,keyRnd:e.randomKey.toBuffer(),mode:e.mode==="WITH_FEE"?1:2},y),new Pe({keys:p,data:y,programId:new M(d.MCTP_PROGRAM_ID)})}var qt=Ce([v(8,"instruction"),v(32,"destAddress"),v(8,"amountInMin"),v(8,"gasDrop"),v(8,"feeRedeem"),v(8,"feeSolana"),tn("destinationChain"),v(32,"keyRnd"),et("mode"),v(32,"tokenOut"),v(8,"amountOutMin"),v(8,"deadline"),v(32,"refAddress"),et("feeRateRef")]);function en(e){let t=new M(e.swapperAddress),n=new M(e.mintAddress),a=F(n,e.ledger,!0),i=k(e.toChain),o=Q.from(N(A(e.destinationAddress,i))),s=_(e.amountInMin64),r=_(w(e.gasDrop,Math.min(B(e.toChain),8))),c=_(w(e.feeRedeem,L)),u=_(e.feeSolana),l=Q.from(N(A(e.tokenOut,i))),p=e.referrerAddress?Q.from(N(A(e.referrerAddress,i))):ye.programId.toBuffer(),y=_(w(e.amountOutMin,Math.min(8,e.tokenOutDecimals))),m=_(e.deadline),f=[{pubkey:t,isWritable:!0,isSigner:!0},{pubkey:e.ledger,isWritable:!0,isSigner:!1},{pubkey:a,isWritable:!1,isSigner:!1},{pubkey:n,isWritable:!1,isSigner:!1},{pubkey:ye.programId,isWritable:!1,isSigner:!1}],b=Q.alloc(qt.span);return qt.encode({instruction:Z("init_order_ledger"),destAddress:o,amountInMin:s,gasDrop:r,feeRedeem:c,feeSolana:u,destinationChain:i,keyRnd:e.randomKey.toBuffer(),mode:3,tokenOut:l,refAddress:p,amountOutMin:y,deadline:m,feeRateRef:e.feeRateRef},b),new Pe({keys:f,data:b,programId:new M(d.MCTP_PROGRAM_ID)})}async function nn(e,t,n,a,i,o={}){let s=o?.forceSkipCctpInstructions||!1,r=o?.allowSwapperOffCurve||!1;if(e.toChain==="solana")throw new Error("Unsupported destination chain: "+e.toChain);let c=[],u=[],l=[],p=[],y=[],m=[],f=[],b=be.generate(),T=null;c.push(d.LOOKUP_TABLE);let h=new M(d.MCTP_PROGRAM_ID),g=new M(t),S=be.generate(),R=e.deadline64?BigInt(e.deadline64):BigInt(0);if(e.hasAuction&&!Number(e.deadline64))throw new Error("Swap mode requires a timeout");let C=e.hasAuction?"LEDGER_ORDER":"LEDGER_BRIDGE",[I]=M.findProgramAddressSync([Q.from(C),g.toBytes(),S.publicKey.toBytes()],h),E=F(new M(e.mctpInputContract),I,!0),x=e.cheaperChain==="solana"?"LOCK_FEE":"WITH_FEE",K=e.toChain==="sui"?e.toToken.verifiedAddress:e.toToken.contract;if(e.fromToken.contract===e.mctpInputContract){let P=BigInt(s?e.solanaRelayerFee64:0);if(e.suggestedPriorityFee>0&&u.push(ua.setComputeUnitPrice({microLamports:e.suggestedPriorityFee})),u.push($(g,E,I,new M(e.mctpInputContract))),u.push(Me(F(new M(e.mctpInputContract),g,r),E,g,BigInt(e.effectiveAmountIn64))),e.hasAuction){if(u.push(en({ledger:I,swapperAddress:t,mintAddress:e.mctpInputContract,randomKey:S.publicKey,toChain:e.toChain,destinationAddress:n,feeSolana:P,feeRedeem:e.redeemRelayerFee,gasDrop:e.gasDrop,amountInMin64:BigInt(e.effectiveAmountIn64),tokenOut:K,tokenOutDecimals:e.toToken.decimals,referrerAddress:a,amountOutMin:e.minAmountOut,deadline:R,feeRateRef:e.referrerBps})),!s){let{instruction:O,signer:U}=jt(I,e.toChain,e.mctpInputContract,t,P);u.push(O),l.push(U)}}else if(u.push(Xt({ledger:I,swapperAddress:t,mintAddress:e.mctpInputContract,randomKey:S.publicKey,toChain:e.toChain,destinationAddress:n,feeSolana:P,feeRedeem:e.redeemRelayerFee,gasDrop:e.gasDrop,amountInMin64:BigInt(e.effectiveAmountIn64),mode:x,referrerAddress:a})),!s)if(x==="WITH_FEE"){let{instruction:O,signers:U}=Yt(I,e.toChain,e.mctpInputContract,t,P);u.push(O),l.push(...U)}else{let{instructions:O,signer:U}=zt(I,e.toChain,e.mctpInputContract,t,P);u.push(...O),l.push(U)}}else{let P=await Re({minMiddleAmount:e.minMiddleAmount,middleToken:e.mctpInputContract,userWallet:t,userLedger:I.toString(),slippageBps:e.slippageBps,fromToken:e.fromToken.contract,amountIn64:e.effectiveAmountIn64,depositMode:e.hasAuction?"SWAP":x,fillMaxAccounts:o?.separateSwapTx||!1,tpmTokenAccount:o?.separateSwapTx?b.publicKey.toString():null}),O=Ne(P,i);o?.separateSwapTx&&P.maxAccountsFilled?(Se(O,b.publicKey,g),f=await Be(i,g,new M(e.mctpInputContract),g,b),m.push(...O.computeBudgetInstructions),O.setupInstructions&&m.push(...O.setupInstructions),m.push(O.swapInstruction),O.cleanupInstruction&&m.push(O.cleanupInstruction),y.push(...O.addressLookupTableAddresses),u.push($(g,E,I,new M(e.mctpInputContract))),u.push(We(g,new M(e.mctpInputContract),b.publicKey,E,g))):(Se(O,E,g),u.push(...O.computeBudgetInstructions),O.setupInstructions&&u.push(...O.setupInstructions),u.push(O.swapInstruction),O.cleanupInstruction&&u.push(O.cleanupInstruction),c.push(...O.addressLookupTableAddresses));let U=m.length>0?BigInt(0):BigInt(e.solanaRelayerFee64);if(e.hasAuction){if(u.push(en({ledger:I,swapperAddress:t,mintAddress:e.mctpInputContract,randomKey:S.publicKey,toChain:e.toChain,destinationAddress:n,feeSolana:U,feeRedeem:e.redeemRelayerFee,gasDrop:e.gasDrop,amountInMin64:w(e.minMiddleAmount,L),tokenOut:K,tokenOutDecimals:e.toToken.decimals,referrerAddress:a,amountOutMin:e.minAmountOut,deadline:R,feeRateRef:e.referrerBps})),m.length>0){let{instruction:ae,signer:J}=jt(I,e.toChain,e.mctpInputContract,t,U);u.push(ae),l.push(J)}}else if(u.push(Xt({ledger:I,swapperAddress:t,mintAddress:e.mctpInputContract,randomKey:S.publicKey,toChain:e.toChain,destinationAddress:n,feeSolana:U,feeRedeem:e.redeemRelayerFee,gasDrop:e.gasDrop,amountInMin64:w(e.minMiddleAmount,L),mode:x,referrerAddress:a})),m.length>0)if(x==="WITH_FEE"){let{instruction:ae,signers:J}=Yt(I,e.toChain,e.mctpInputContract,t,U);u.push(ae),l.push(...J)}else{let{instructions:ae,signer:J}=zt(I,e.toChain,e.mctpInputContract,t,U);u.push(...ae),l.push(J)}}let W=await ve(c.concat(y),i);if(p=W.slice(0,c.length),m.length>0){let P=W.slice(c.length);T={messageV0:{payerKey:g,instructions:m,addressLookupTableAccounts:P},createTmpTokenAccountIxs:f,tmpTokenAccount:b}}return{instructions:u,signers:l,lookupTables:p,swapMessageV0Params:T}}import{PublicKey as ne,Keypair as an,SystemProgram as Te,TransactionInstruction as pa,ComputeBudgetProgram as la}from"@solana/web3.js";import{blob as z,struct as ca,u16 as ya,u8 as Ke}from"@solana/buffer-layout";import{Buffer as V}from"buffer";import{ethers as da,ZeroAddress as ge}from"ethers";function tt(e,t,n,a,i){let s=V.alloc(239),r=0,c=k(e.fromChain),u=V.from(N(A(t,c)));s.set(u,0),r+=32,s.writeUInt16BE(c,r),r+=2;let l=e.swiftInputContract===ge?A(Te.programId.toString(),k("solana")):A(e.swiftInputContract,c),p=V.from(N(l));s.set(p,r),r+=32;let y=k(e.toChain),m=V.from(N(A(n,y)));s.set(m,r),r+=32,s.writeUInt16BE(y,r),r+=2;let f=e.toToken.contract===ge?A(Te.programId.toString(),k("solana")):A(e.toToken.contract,y),b=V.from(N(f));s.set(b,r),r+=32,s.writeBigUInt64BE(w(e.minAmountOut,Math.min(e.toToken.decimals,8)),r),r+=8,s.writeBigUInt64BE(w(e.gasDrop,Math.min(B(e.toChain),8)),r),r+=8,s.writeBigUInt64BE(BigInt(e.cancelRelayerFee64),r),r+=8,s.writeBigUInt64BE(BigInt(e.refundRelayerFee64),r),r+=8,s.writeBigUInt64BE(BigInt(e.deadline64),r),r+=8;let T=a?V.from(N(A(a,y))):Te.programId.toBuffer();s.set(T,r),r+=32,s.writeUInt8(e.referrerBps,r),r+=1;let h=e.protocolBps;s.writeUInt8(h,r),r+=1,s.writeUInt8(e.swiftAuctionMode,r),r+=1;let g=V.from(N(i));if(s.set(g,r),r+=32,r!==239)throw new Error(`Invalid order data size: ${r}`);let S=da.keccak256(s);return V.from(N(S))}var rn=ca([z(8,"instruction"),z(8,"amountInMin"),Ke("nativeInput"),z(8,"feeSubmit"),z(32,"destAddress"),ya("destinationChain"),z(32,"tokenOut"),z(8,"amountOutMin"),z(8,"gasDrop"),z(8,"feeCancel"),z(8,"feeRefund"),z(8,"deadline"),z(32,"refAddress"),Ke("feeRateRef"),Ke("feeRateMayan"),Ke("auctionMode"),z(32,"randomKey")]);function ma(e){let{quote:t}=e,n=t.swiftInputContract===ge?te:new ne(t.swiftInputContract),a=k(t.toChain);if(a!==t.toToken.wChainId)throw new Error(`Destination chain ID mismatch: ${a} != ${t.toToken.wChainId}`);let i=[{pubkey:e.trader,isWritable:!1,isSigner:!0},{pubkey:e.relayer,isWritable:!0,isSigner:!0},{pubkey:e.state,isWritable:!0,isSigner:!1},{pubkey:e.stateAccount,isWritable:!0,isSigner:!1},{pubkey:e.relayerAccount,isWritable:!0,isSigner:!1},{pubkey:n,isWritable:!1,isSigner:!1},{pubkey:new ne(d.FEE_MANAGER_PROGRAM_ID),isWritable:!1,isSigner:!1},{pubkey:new ne(d.TOKEN_PROGRAM_ID),isWritable:!1,isSigner:!1},{pubkey:Te.programId,isWritable:!1,isSigner:!1}],o=V.alloc(rn.span),s=e.referrerAddress?V.from(N(A(e.referrerAddress,a))):Te.programId.toBuffer(),r=t.fromToken.contract===t.swiftInputContract?BigInt(t.effectiveAmountIn64):w(t.minMiddleAmount,t.swiftInputDecimals);return rn.encode({instruction:Z("init_order"),amountInMin:_(r),nativeInput:t.swiftInputContract===ge?1:0,feeSubmit:_(BigInt(t.submitRelayerFee64)),destAddress:V.from(N(A(e.destinationAddress,a))),destinationChain:a,tokenOut:V.from(N(A(t.toToken.contract,a))),amountOutMin:_(w(t.minAmountOut,Math.min(t.toToken.decimals,8))),gasDrop:_(w(t.gasDrop,Math.min(B(t.toChain),8))),feeCancel:_(BigInt(t.cancelRelayerFee64)),feeRefund:_(BigInt(t.refundRelayerFee64)),deadline:_(e.deadline),refAddress:s,feeRateRef:t.referrerBps,feeRateMayan:t.protocolBps,auctionMode:t.swiftAuctionMode,randomKey:e.randomKey.toBuffer()},o),new pa({keys:i,data:o,programId:new ne(d.SWIFT_PROGRAM_ID)})}async function sn(e,t,n,a,i,o={}){if(e.type!=="SWIFT")throw new Error("Unsupported quote type for Swift: "+e.type);if(e.toChain==="solana")throw new Error("Unsupported destination chain: "+e.toChain);let s=o.allowSwapperOffCurve||!1,r=[],c=[],u=[];u.push(d.LOOKUP_TABLE);let l=[],p=[],y=[],m=an.generate(),f=null,b=new ne(d.SWIFT_PROGRAM_ID),T=new ne(t),h=an.generate();if(!Number(e.deadline64))throw new Error("Swift mode requires a timeout");let g=BigInt(e.deadline64),S=tt(e,t,n,a,h.publicKey.toBuffer().toString("hex")),[R]=ne.findProgramAddressSync([V.from("STATE_SOURCE"),S],b),C=e.swiftInputContract===ge?te:new ne(e.swiftInputContract),I=F(C,R,!0),E=e.gasless?new ne(e.relayer):T,x=F(C,E,!1);if(e.fromToken.contract===e.swiftInputContract)e.suggestedPriorityFee>0&&r.push(la.setComputeUnitPrice({microLamports:e.suggestedPriorityFee})),r.push($(E,I,R,C)),e.swiftInputContract===ge?r.push(Te.transfer({fromPubkey:T,toPubkey:I,lamports:BigInt(e.effectiveAmountIn64)}),Ie(I)):r.push(Me(F(C,T,s),I,T,BigInt(e.effectiveAmountIn64)));else{let W=await Re({minMiddleAmount:e.minMiddleAmount,middleToken:e.swiftInputContract,userWallet:t,slippageBps:e.slippageBps,fromToken:e.fromToken.contract,amountIn64:e.effectiveAmountIn64,depositMode:e.gasless?"SWIFT_GASLESS":"SWIFT",orderHash:`0x${S.toString("hex")}`,fillMaxAccounts:o?.separateSwapTx||!1,tpmTokenAccount:o?.separateSwapTx?m.publicKey.toString():null}),P=Ne(W,i);o?.separateSwapTx&&W.maxAccountsFilled?(Se(P,m.publicKey,T),y=await Be(i,E,C,T,m),p.push(...P.computeBudgetInstructions),P.setupInstructions&&p.push(...P.setupInstructions),p.push(P.swapInstruction),P.cleanupInstruction&&p.push(P.cleanupInstruction),l.push(...P.addressLookupTableAddresses),r.push($(E,I,R,C)),r.push(We(T,C,m.publicKey,I,E))):(r.push(...P.computeBudgetInstructions),P.setupInstructions&&r.push(...P.setupInstructions),r.push(P.swapInstruction),P.cleanupInstruction&&r.push(P.cleanupInstruction),u.push(...P.addressLookupTableAddresses))}r.push(ma({quote:e,state:R,trader:T,stateAccount:I,randomKey:h.publicKey,relayerAccount:x,relayer:E,destinationAddress:n,deadline:g,referrerAddress:a}));let K=await ve(u.concat(l),i);if(c=K.slice(0,u.length),p.length>0){let W=K.slice(u.length);f={messageV0:{payerKey:E,instructions:p,addressLookupTableAccounts:W},createTmpTokenAccountIxs:y,tmpTokenAccount:m}}return{instructions:r,signers:[],lookupTables:c,swapMessageV0Params:f}}var ha=420,ln=wa([we("instruction"),we("stateNonce"),oe(8,"amount"),oe(8,"minAmountOut"),oe(8,"deadline"),oe(8,"feeSwap"),oe(8,"feeReturn"),oe(8,"feeCancel"),oe(8,"gasDrop"),Aa("destinationChain"),oe(32,"destinationAddress"),we("unwrapRedeem"),we("unwrapRefund"),we("mayanFeeNonce"),we("referrerFeeNonce")]);async function Ia(e,t,n,a,i,o={}){let s=he(e,a);if(e.type==="MCTP")return nn(e,t,n,s,i,o);if(e.type==="SWIFT")return sn(e,t,n,s,i,o);let r=[],c=i??new cn("https://rpc.ankr.com/solana"),u=new Y(d.MAYAN_PROGRAM_ID),l=new Y(d.TOKEN_PROGRAM_ID),p=new Y(t),y=new Y(d.AUCTION_PROGRAM_ID);e.suggestedPriorityFee>0&&r.push(ga.setComputeUnitPrice({microLamports:e.suggestedPriorityFee}));let m;s?m=new Y(s):m=Le.programId;let[f,b]=Y.findProgramAddressSync([ue.from("MAYANFEE")],u),[T,h]=Y.findProgramAddressSync([ue.from("REFERRERFEE"),m.toBuffer()],u),g=nt.generate(),S=nt.generate(),[R,C]=Y.findProgramAddressSync([ue.from("V2STATE"),ue.from(g.publicKey.toBytes()),ue.from(S.publicKey.toBytes())],u),I=new Y(e.fromToken.mint),E=new Y(e.toToken.mint),x=F(I,p),K=F(I,R,!0),[[W,P],O,U]=await Promise.all([c.getMultipleAccountsInfo([x,K],"finalized"),c.getMinimumBalanceForRentExemption(ha),Lt()]);(!W||W.data.length===0)&&r.push($(p,x,p,I)),(!P||P.data.length===0)&&r.push($(p,K,R,I)),e.fromToken.contract===rt&&(r.push(Le.transfer({fromPubkey:p,toPubkey:x,lamports:BigInt(e.effectiveAmountIn64)})),r.push(Ie(x)));let ae=BigInt(e.effectiveAmountIn64),J=nt.generate();r.push(Kt(x,J.publicKey,p,ae)),r.push(Le.transfer({fromPubkey:p,toPubkey:J.publicKey,lamports:O}));let kn=[{pubkey:J.publicKey,isWritable:!1,isSigner:!0},{pubkey:g.publicKey,isWritable:!1,isSigner:!0},{pubkey:S.publicKey,isWritable:!1,isSigner:!0},{pubkey:R,isWritable:!0,isSigner:!1},{pubkey:x,isWritable:!0,isSigner:!1},{pubkey:p,isWritable:!1,isSigner:!1},{pubkey:K,isWritable:!0,isSigner:!1},{pubkey:I,isWritable:!1,isSigner:!1},{pubkey:E,isWritable:!1,isSigner:!1},{pubkey:y,isWritable:!1,isSigner:!1},{pubkey:m,isWritable:!1,isSigner:!1},{pubkey:f,isWritable:!1,isSigner:!1},{pubkey:T,isWritable:!1,isSigner:!1},{pubkey:J.publicKey,isWritable:!0,isSigner:!0},{pubkey:U,isWritable:!1,isSigner:!1},{pubkey:fa,isWritable:!1,isSigner:!1},{pubkey:ba,isWritable:!1,isSigner:!1},{pubkey:l,isWritable:!1,isSigner:!1},{pubkey:Le.programId,isWritable:!1,isSigner:!1}],He=k(e.toChain);if(He===1){let Qe=await c.getAccountInfo(new Y(n));if(Qe&&Qe.owner&&Qe.owner.equals(l))throw new Error("Destination address is not about token account. It should be a owner address")}let Rn=ue.from(N(A(n,He))),_n=w(e.minAmountOut,e.mintDecimals.to),En=w(e.swapRelayerFee,e.mintDecimals.from),On=w(e.redeemRelayerFee,e.mintDecimals.to),Fn=w(e.refundRelayerFee,e.mintDecimals.from),Dn=w(e.gasDrop,bt(e.toChain)),xn=e.toToken.contract===rt,Bn=e.fromToken.contract===rt;if(!Number(e.deadline64))throw new Error("Deadline is not valid");let vn=BigInt(e.deadline64),yt=ue.alloc(ln.span),Nn={instruction:101,stateNonce:C,amount:_(ae),minAmountOut:_(_n),deadline:_(vn),feeSwap:_(En),feeReturn:_(On),feeCancel:_(Fn),gasDrop:_(Dn),destinationChain:He,destinationAddress:Rn,unwrapRedeem:xn?1:0,unwrapRefund:Bn?1:0,mayanFeeNonce:b,referrerFeeNonce:h};ln.encode(Nn,yt);let Wn=new Ta({keys:kn,data:yt,programId:u});return r.push(Wn),{instructions:r,signers:[J,g,S],lookupTables:[],swapMessageV0Params:null}}async function ui(e,t,n,a,i,o,s,r,c,u){let l=o??new cn("https://rpc.ankr.com/solana"),p=!!(!e.gasless&&c&&c.tipLamports>0&&c.signAllTransactions),{instructions:y,signers:m,lookupTables:f,swapMessageV0Params:b}=await Ia(e,t,n,a,o,{allowSwapperOffCurve:u?.allowSwapperOffCurve,forceSkipCctpInstructions:u?.forceSkipCctpInstructions,separateSwapTx:p&&c?.separateSwapTx}),T=new Y(t),h=e.gasless?new Y(e.relayer):T,{blockhash:g,lastValidBlockHeight:S}=await o.getLatestBlockhash(),R=un.compile({instructions:y,payerKey:h,recentBlockhash:g,addressLookupTableAccounts:f}),C=new at(R);C.sign(m);let I;if(p){let E=[];if(b){let P=new on({feePayer:T,blockhash:g,lastValidBlockHeight:S}).add(...b.createTmpTokenAccountIxs);P.partialSign(b.tmpTokenAccount),E.push(P);let O=un.compile({...b.messageV0,recentBlockhash:g});E.push(new at(O))}let x=Ut(t,g,S,c);E.push(C),E.push(x);let K=await c.signAllTransactions(E);I=K[K.length-2];let W=null;if(I instanceof on&&I?.signatures[0]?.publicKey?W=pn(Uint8Array.from(I.signatures[0].signature)):I instanceof at&&I?.signatures[0]&&(W=pn(Uint8Array.from(I.signatures[0]))),W===null)throw new Error("Failed to get mayan tx hash");if(b){let P=await qe(K,c,!0);return await Gt(P,c,S,W,o),Ht(P),{signature:W,serializedTrx:null}}else qe(K,c).then(()=>{console.log("Jito bundle sent")}).catch(()=>{})}else I=await i(C);if(e.gasless){let E=ue.from(I.serialize()).toString("base64"),{orderHash:x}=await St(E);return{signature:x,serializedTrx:null}}return await xe({trx:I.serialize(),connection:l,extraRpcs:s??[],errorChance:2,options:r})}function mn(e,t,n,a,i){let o=H(Number(i)),s=k(e.fromChain),r=k(e.toChain);if(s!==o)throw new Error(`Signer chain id(${Number(i)}) and quote from chain are not same! ${s} !== ${o}`);if(!e.swiftMayanContract)throw new Error("SWIFT contract address is missing");if(e.toToken.wChainId!==r)throw new Error(`Destination chain ID mismatch: ${r} != ${e.toToken.wChainId}`);let c=e.swiftMayanContract;if(!Number(e.deadline64))throw new Error("Swift order requires timeout");let u=BigInt(e.deadline64),l=e.swiftInputContract,p=BigInt(e.effectiveAmountIn64),y;a?y=A(a,r):y=A(dn.programId.toString(),1);let m=A(Ma.generate().publicKey.toString(),1),f=e.toToken.contract===Ge?A(dn.programId.toString(),1):A(e.toToken.contract,r),b=w(e.minAmountOut,Math.min(8,e.toToken.decimals)),T=w(e.gasDrop,Math.min(8,B(e.toChain))),h=A(n,r),g={trader:A(t,s),tokenOut:f,minAmountOut:b,gasDrop:T,cancelFee:BigInt(e.cancelRelayerFee64),refundFee:BigInt(e.refundRelayerFee64),deadline:u,destAddr:h,destChainId:r,referrerAddr:y,referrerBps:e.referrerBps||0,auctionMode:e.swiftAuctionMode,random:m};return{contractAddress:c,tokenIn:l,amountIn:p,order:g}}function fn(e,t,n,a,i,o){if(e.type!=="SWIFT")throw new Error("Quote type is not SWIFT");if(!Number.isFinite(Number(i)))throw new Error("Invalid signer chain id");if(!Number(e.deadline64))throw new Error("Swift order requires timeout");i=Number(i);let s=o||X,r=new yn(d.MAYAN_FORWARDER_CONTRACT,q.abi),{tokenIn:c,amountIn:u,order:l,contractAddress:p}=mn(e,t,n,a,i),y,m=new yn(p,Et.abi);e.swiftInputContract===Ge?y=m.interface.encodeFunctionData("createOrderWithEth",[l]):y=m.interface.encodeFunctionData("createOrderWithToken",[c,u,l]);let f,b,T;if(e.fromToken.contract===e.swiftInputContract)e.fromToken.contract===Ge?(f="forwardEth",b=[p,y],T=Ue(u)):(f="forwardERC20",b=[c,u,s,p,y],T=Ue(0));else{let{evmSwapRouterAddress:g,evmSwapRouterCalldata:S}=e;if(!e.minMiddleAmount||!g||!S)throw new Error("Swift swap requires middle amount, router address and calldata");let R=e.fromToken.contract,C=w(e.minMiddleAmount,e.swiftInputDecimals);e.fromToken.contract===Ge?(f="swapAndForwardEth",b=[u,g,S,e.swiftInputContract,C,p,y],T=Ue(u)):(f="swapAndForwardERC20",b=[R,u,s,g,S,e.swiftInputContract,C,p,y],T=Ue(0))}return{data:r.interface.encodeFunctionData(f,b),to:d.MAYAN_FORWARDER_CONTRACT,value:T,chainId:i,_forwarder:{method:f,params:b}}}function Sa(e,t,n){if(!Number.isFinite(Number(n)))throw new Error("Invalid signer chain id");let a=BigInt(e.effectiveAmountIn64),i=BigInt(e.submitRelayerFee64);return{domain:{name:"Mayan Swift",chainId:Number(n),verifyingContract:e.swiftMayanContract},types:{CreateOrder:[{name:"OrderId",type:"bytes32"},{name:"InputAmount",type:"uint256"},{name:"SubmissionFee",type:"uint256"}]},value:{OrderId:t,InputAmount:a-i,SubmissionFee:i}}}function bn(e,t,n,a,i,o){if(e.type!=="SWIFT")throw new Error("Quote type is not SWIFT");if(!e.gasless)throw new Error("Quote does not support gasless");if(!Number.isFinite(Number(i)))throw new Error("Invalid signer chain id");if(!Number(e.deadline64))throw new Error("Swift order requires timeout");if(e.fromToken.contract!==e.swiftInputContract)throw new Error("Swift gasless order creation does not support source swap");let{tokenIn:s,amountIn:r,order:c}=mn(e,t,n,a,Number(i)),u=k(e.fromChain),p=`0x${tt(e,t,n,a,c.random).toString("hex")}`,y=Sa(e,p,i);return{permitParams:o,orderParams:{...c,sourceChainId:u,amountIn:r,tokenIn:s,submissionFee:BigInt(e.submitRelayerFee64)},orderHash:p,orderTypedData:y}}import{Contract as gn,toBeHex as it,ZeroAddress as wn}from"ethers";var Tn={abi:[{type:"function",name:"batchMaxApprove",inputs:[{name:"approvals",type:"bytes",internalType:"bytes"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"initiate",inputs:[{name:"recipient",type:"bytes32",internalType:"bytes32"},{name:"overrideAmountIn",type:"uint256",internalType:"uint256"},{name:"targetChain",type:"uint16",internalType:"uint16"},{name:"params",type:"bytes",internalType:"bytes"}],outputs:[{name:"",type:"bytes",internalType:"bytes"}],stateMutability:"payable"},{type:"error",name:"ChainNotSupported",inputs:[{name:"chain",type:"uint16",internalType:"uint16"}]},{type:"error",name:"DeadlineExpired",inputs:[{name:"blocktime",type:"uint256",internalType:"uint256"},{name:"deadline",type:"uint256",internalType:"uint256"}]},{type:"error",name:"EthTransferFailed",inputs:[]},{type:"error",name:"ExceedsMaxGasDropoff",inputs:[{name:"requested",type:"uint256",internalType:"uint256"},{name:"maximum",type:"uint256",internalType:"uint256"}]},{type:"error",name:"ExceedsMaxRelayingFee",inputs:[{name:"fee",type:"uint256",internalType:"uint256"},{name:"maximum",type:"uint256",internalType:"uint256"}]},{type:"error",name:"InsufficientInputAmount",inputs:[{name:"input",type:"uint256",internalType:"uint256"},{name:"minimum",type:"uint256",internalType:"uint256"}]},{type:"error",name:"InvalidAddress",inputs:[{name:"addr",type:"bytes32",internalType:"bytes32"}]},{type:"error",name:"InvalidBoolVal",inputs:[{name:"val",type:"uint8",internalType:"uint8"}]},{type:"error",name:"InvalidOverrideAmount",inputs:[{name:"received",type:"uint256",internalType:"uint256"},{name:"maximum",type:"uint256",internalType:"uint256"}]},{type:"error",name:"InvalidSwapType",inputs:[{name:"swapType",type:"uint256",internalType:"uint256"}]},{type:"error",name:"InvalidSwapTypeForChain",inputs:[{name:"chain",type:"uint16",internalType:"uint16"},{name:"swapType",type:"uint256",internalType:"uint256"}]},{type:"error",name:"LengthMismatch",inputs:[{name:"encodedLength",type:"uint256",internalType:"uint256"},{name:"expectedLength",type:"uint256",internalType:"uint256"}]},{type:"error",name:"RelayingDisabledForChain",inputs:[]}]};var pe={FAST_MODE_FLAG:1,RELAY_REDEEM_MODE:2,EXACT_IN_FLAG:1,USDC_INPUT_TOKEN_TYPE:0,PRE_APPROVED_ACQUIRE_MODE:0,OUTPUT_USDC_MODE:0,OUTPUT_NATIVE_MODE:1,OUTPUT_OTHER_MODE:2};function Pa(e){let t=(1n<<128n)-1n;if(e<0n||e>t)throw new RangeError("Value must fit in an unsigned 128-bit integer (0 <= value < 2^128)");let n=Buffer.alloc(16);for(let a=15;a>=0;a--)n[a]=Number(e&0xffn),e>>=8n;return n}function Ca(e,t,n){let{shuttleParams:a}=e;if(!a)throw new Error("Swap layer params are missing in quote response");let i=H(Number(n)),o=k(e.fromChain),s=k(e.toChain);if(o!==i)throw new Error(`Signer chain id(${Number(n)}) and quote from chain are not same! ${o} !== ${i}`);let r=[];r.push(pe.FAST_MODE_FLAG);let c=Buffer.alloc(8);c.writeBigUInt64BE(BigInt(a.maxLLFee));let u=c.subarray(2);r.push(...u);let l=Buffer.alloc(4);l.writeUInt32BE(a.fastTransferDeadline),r.push(...l),r.push(pe.RELAY_REDEEM_MODE);let p=w(e.gasDrop,Math.min(6,B(e.toChain))),y=Buffer.alloc(8);y.writeBigUInt64BE(p);let m=y.subarray(4);r.push(...m);let f=Buffer.alloc(8);f.writeBigUInt64BE(BigInt(a.maxRelayingFee));let b=f.subarray(2);r.push(...b),r.push(pe.EXACT_IN_FLAG),r.push(pe.USDC_INPUT_TOKEN_TYPE);let T=BigInt(e.effectiveAmountIn64);if(e.fromToken.contract===e.shuttleInputContract){r.push(...Array(8).fill(0));let g=Buffer.alloc(8);g.writeBigUInt64BE(T),r.push(...g)}else r.push(...Array(16).fill(0));if(r.push(pe.PRE_APPROVED_ACQUIRE_MODE),a.hasDestSwap){if(e.toToken.contract===wn)r.push(pe.OUTPUT_NATIVE_MODE);else{r.push(pe.OUTPUT_OTHER_MODE);let C=Buffer.from(A(e.toToken.contract,s).slice(2),"hex");r.push(...C)}let g=Buffer.alloc(4);g.writeUInt32BE(Number(BigInt(e.deadline64))),r.push(...g);let S=w(e.minAmountOut,e.toToken.decimals);if(e.toChain==="solana"){r.push(...Array(8).fill(0));let C=Buffer.alloc(8);C.writeBigUInt64BE(S),r.push(...C)}else{let C=Pa(S);r.push(...C)}let R=Buffer.from(a.path.slice(2),"hex");r.push(...R)}else r.push(pe.OUTPUT_USDC_MODE);return{destAddr:A(t,s),destChainId:s,serializedParams:`0x${Buffer.from(r).toString("hex")}`,contractAddress:e.shuttleContract,amountIn:T,bridgeFee:w(e.bridgeFee,B(e.fromChain))}}function An(e,t,n,a){if(e.type!=="SHUTTLE")throw new Error("Quote type is not SHUTTLE");if(!Number.isFinite(Number(n)))throw new Error("Invalid signer chain id");n=Number(n);let i=a||X,o=new gn(d.MAYAN_FORWARDER_CONTRACT,q.abi),{destAddr:s,destChainId:r,serializedParams:c,contractAddress:u,amountIn:l,bridgeFee:p}=Ca(e,t,n),y;y=new gn(u,Tn.abi).interface.encodeFunctionData("initiate",[s,l,r,c]);let f,b,T;if(e.fromToken.contract===e.shuttleInputContract)f="forwardERC20",b=[e.shuttleInputContract,l,i,u,y],T=it(p);else{let{evmSwapRouterAddress:g,evmSwapRouterCalldata:S}=e;if(!e.minMiddleAmount||!g||!S)throw new Error("Shuttle source chain swap requires middle amount, router address and calldata");let R=e.fromToken.contract,C=w(e.minMiddleAmount,e.shuttleInputDecimals);e.fromToken.contract===wn?(f="swapAndForwardEth",b=[l,g,S,e.shuttleInputContract,C,u,y],T=it(l)):(f="swapAndForwardERC20",b=[R,l,i,g,S,e.shuttleInputContract,C,u,y],T=it(p))}return{data:o.interface.encodeFunctionData(f,b),to:d.MAYAN_FORWARDER_CONTRACT,value:T,chainId:n,_forwarder:{method:f,params:b}}}import{Contract as pt,toBeHex as le,ZeroAddress as ot}from"ethers";import{SystemProgram as ut}from"@solana/web3.js";var st={abi:[{type:"constructor",inputs:[{name:"_cctpTokenMessengerV2",type:"address",internalType:"address"},{name:"_feeManager",type:"address",internalType:"address"}],stateMutability:"nonpayable"},{type:"receive",stateMutability:"payable"},{type:"function",name:"bridge",inputs:[{name:"tokenIn",type:"address",internalType:"address"},{name:"amountIn",type:"uint256",internalType:"uint256"},{name:"redeemFee",type:"uint64",internalType:"uint64"},{name:"circleMaxFee",type:"uint256",internalType:"uint256"},{name:"gasDrop",type:"uint64",internalType:"uint64"},{name:"destAddr",type:"bytes32",internalType:"bytes32"},{name:"destDomain",type:"uint32",internalType:"uint32"},{name:"referrerAddress",type:"bytes32",internalType:"bytes32"},{name:"referrerBps",type:"uint8",internalType:"uint8"},{name:"payloadType",type:"uint8",internalType:"uint8"},{name:"minFinalityThreshold",type:"uint32",internalType:"uint32"},{name:"customPayload",type:"bytes",internalType:"bytes"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"cctpTokenMessengerV2",inputs:[],outputs:[{name:"",type:"address",internalType:"contract ITokenMessengerV2"}],stateMutability:"view"},{type:"function",name:"changeGuardian",inputs:[{name:"newGuardian",type:"address",internalType:"address"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"claimGuardian",inputs:[],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"createOrder",inputs:[{name:"tokenIn",type:"address",internalType:"address"},{name:"amountIn",type:"uint256",internalType:"uint256"},{name:"circleMaxFee",type:"uint256",internalType:"uint256"},{name:"destDomain",type:"uint32",internalType:"uint32"},{name:"minFinalityThreshold",type:"uint32",internalType:"uint32"},{name:"orderPayload",type:"tuple",internalType:"struct FastMCTP.OrderPayload",components:[{name:"payloadType",type:"uint8",internalType:"uint8"},{name:"destAddr",type:"bytes32",internalType:"bytes32"},{name:"tokenOut",type:"bytes32",internalType:"bytes32"},{name:"amountOutMin",type:"uint64",internalType:"uint64"},{name:"gasDrop",type:"uint64",internalType:"uint64"},{name:"redeemFee",type:"uint64",internalType:"uint64"},{name:"refundFee",type:"uint64",internalType:"uint64"},{name:"deadline",type:"uint64",internalType:"uint64"},{name:"referrerAddr",type:"bytes32",internalType:"bytes32"},{name:"referrerBps",type:"uint8",internalType:"uint8"}]}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"domainToCaller",inputs:[{name:"",type:"uint32",internalType:"uint32"}],outputs:[{name:"",type:"bytes32",internalType:"bytes32"}],stateMutability:"view"},{type:"function",name:"feeManager",inputs:[],outputs:[{name:"",type:"address",internalType:"address"}],stateMutability:"view"},{type:"function",name:"fulfillOrder",inputs:[{name:"cctpMsg",type:"bytes",internalType:"bytes"},{name:"cctpSigs",type:"bytes",internalType:"bytes"},{name:"swapProtocol",type:"address",internalType:"address"},{name:"swapData",type:"bytes",internalType:"bytes"}],outputs:[],stateMutability:"payable"},{type:"function",name:"guardian",inputs:[],outputs:[{name:"",type:"address",internalType:"address"}],stateMutability:"view"},{type:"function",name:"keyToMintRecipient",inputs:[{name:"",type:"bytes32",internalType:"bytes32"}],outputs:[{name:"",type:"bytes32",internalType:"bytes32"}],stateMutability:"view"},{type:"function",name:"nextGuardian",inputs:[],outputs:[{name:"",type:"address",internalType:"address"}],stateMutability:"view"},{type:"function",name:"paused",inputs:[],outputs:[{name:"",type:"bool",internalType:"bool"}],stateMutability:"view"},{type:"function",name:"redeem",inputs:[{name:"cctpMsg",type:"bytes",internalType:"bytes"},{name:"cctpSigs",type:"bytes",internalType:"bytes"}],outputs:[],stateMutability:"payable"},{type:"function",name:"refund",inputs:[{name:"cctpMsg",type:"bytes",internalType:"bytes"},{name:"cctpSigs",type:"bytes",internalType:"bytes"}],outputs:[],stateMutability:"payable"},{type:"function",name:"rescueEth",inputs:[{name:"amount",type:"uint256",internalType:"uint256"},{name:"to",type:"address",internalType:"address payable"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"rescueRedeem",inputs:[{name:"cctpMsg",type:"bytes",internalType:"bytes"},{name:"cctpSigs",type:"bytes",internalType:"bytes"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"rescueToken",inputs:[{name:"token",type:"address",internalType:"address"},{name:"amount",type:"uint256",internalType:"uint256"},{name:"to",type:"address",internalType:"address"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"setDomainCallers",inputs:[{name:"domain",type:"uint32",internalType:"uint32"},{name:"caller",type:"bytes32",internalType:"bytes32"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"setFeeManager",inputs:[{name:"_feeManager",type:"address",internalType:"address"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"setMintRecipient",inputs:[{name:"destDomain",type:"uint32",internalType:"uint32"},{name:"tokenIn",type:"address",internalType:"address"},{name:"mintRecipient",type:"bytes32",internalType:"bytes32"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"setPause",inputs:[{name:"_pause",type:"bool",internalType:"bool"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"setWhitelistedMsgSenders",inputs:[{name:"sender",type:"address",internalType:"address"},{name:"isWhitelisted",type:"bool",internalType:"bool"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"setWhitelistedSwapProtocols",inputs:[{name:"protocol",type:"address",internalType:"address"},{name:"isWhitelisted",type:"bool",internalType:"bool"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"whitelistedMsgSenders",inputs:[{name:"",type:"address",internalType:"address"}],outputs:[{name:"",type:"bool",internalType:"bool"}],stateMutability:"view"},{type:"function",name:"whitelistedSwapProtocols",inputs:[{name:"",type:"address",internalType:"address"}],outputs:[{name:"",type:"bool",internalType:"bool"}],stateMutability:"view"},{type:"event",name:"OrderFulfilled",inputs:[{name:"sourceDomain",type:"uint32",indexed:!1,internalType:"uint32"},{name:"sourceNonce",type:"bytes32",indexed:!1,internalType:"bytes32"},{name:"amount",type:"uint256",indexed:!1,internalType:"uint256"}],anonymous:!1},{type:"event",name:"OrderRefunded",inputs:[{name:"sourceDomain",type:"uint32",indexed:!1,internalType:"uint32"},{name:"sourceNonce",type:"bytes32",indexed:!1,internalType:"bytes32"},{name:"amount",type:"uint256",indexed:!1,internalType:"uint256"}],anonymous:!1},{type:"error",name:"AlreadySet",inputs:[]},{type:"error",name:"CallerNotSet",inputs:[]},{type:"error",name:"CctpReceiveFailed",inputs:[]},{type:"error",name:"DeadlineViolation",inputs:[]},{type:"error",name:"EthTransferFailed",inputs:[]},{type:"error",name:"InvalidAddress",inputs:[]},{type:"error",name:"InvalidAmountOut",inputs:[]},{type:"error",name:"InvalidGasDrop",inputs:[]},{type:"error",name:"InvalidMintRecipient",inputs:[]},{type:"error",name:"InvalidPayload",inputs:[]},{type:"error",name:"InvalidPayloadType",inputs:[]},{type:"error",name:"InvalidRedeemFee",inputs:[]},{type:"error",name:"InvalidRefundFee",inputs:[]},{type:"error",name:"MintRecipientNotSet",inputs:[]},{type:"error",name:"Paused",inputs:[]},{type:"error",name:"Unauthorized",inputs:[]},{type:"error",name:"UnauthorizedMsgSender",inputs:[]},{type:"error",name:"UnauthorizedSwapProtocol",inputs:[]}]};function ka(e,t,n,a,i){let o=H(Number(a)),s=k(e.fromChain),r=k(e.toChain);if(s!==o)throw new Error(`Signer chain id(${Number(a)}) and quote from chain are not same! ${s} !== ${o}`);let c=A(t,r),u=w(e.redeemRelayerFee,L),l=w(e.gasDrop,Math.min(B(e.toChain),8)),p=BigInt(e.circleMaxFee64),y=BigInt(e.effectiveAmountIn64),m=me(e.toChain),f;if(n?f=A(n,r):f=A(ut.programId.toString(),k("solana")),!e.fastMctpMayanContract)throw new Error("FastMctp contract address is missing");let b=e.fastMctpMayanContract;return{tokenIn:e.fastMctpInputContract,amountIn:y,redeemFee:u,gasDrop:l,destAddr:c,destDomain:m,referrerAddr:f,referrerBps:e.referrerBps,payloadType:i?At:wt,customPayload:i?`0x${Buffer.from(i).toString("hex")}`:"0x",minFinalityThreshold:Number(e.fastMctpMinFinality),circleMaxFee:p,contractAddress:b}}function hn(e,t,n,a,i){let o=ka(e,t,n,a,i),{contractAddress:s,tokenIn:r,amountIn:c,destAddr:u,redeemFee:l,gasDrop:p,circleMaxFee:y,referrerAddr:m,referrerBps:f,destDomain:b,customPayload:T,minFinalityThreshold:h,payloadType:g}=o,S=new pt(s,st.abi),R,C;return R=S.interface.encodeFunctionData("bridge",[r,c,l,y,p,u,b,m,f,g,h,T]),C=le(0),{to:s,data:R,value:C,_params:o}}function Ra(e,t,n,a){let i=H(Number(a)),o=k(e.fromChain),s=k(e.toChain);if(o!==i)throw new Error(`Signer chain id(${Number(a)}) and quote from chain are not same! ${o} !== ${i}`);if(!e.fastMctpMayanContract)throw new Error("MCTP contract address is missing");let r=e.fastMctpMayanContract,c=A(t,s),u;n?u=A(n,s):u=A(ut.programId.toString(),k("solana"));let l=w(e.redeemRelayerFee,L),p=BigInt(e.refundRelayerFee64),y=BigInt(e.circleMaxFee64),m=w(e.gasDrop,Math.min(B(e.toChain),8)),f=me(e.toChain),b=BigInt(e.effectiveAmountIn64),T=w(e.minAmountOut,Math.min(8,e.toToken.decimals)),h=BigInt(e.deadline64),g=e.toToken.contract===ot?A(ut.programId.toString(),k("solana")):A(e.toChain==="sui"?e.toToken.verifiedAddress:e.toToken.contract,e.toToken.wChainId);return{tokenIn:e.fastMctpInputContract,amountIn:b,circleMaxFee:y,destDomain:f,minFinalityThreshold:Number(e.fastMctpMinFinality),orderPayload:{payloadType:ht,destAddr:c,tokenOut:g,amountOutMin:T,gasDrop:m,redeemFee:l,refundFee:p,deadline:h,referrerAddr:u,referrerBps:e.referrerBps||0},contractAddress:r}}function In(e,t,n,a){let i=Ra(e,t,n,a),{contractAddress:o,orderPayload:s,tokenIn:r,amountIn:c,circleMaxFee:u,destDomain:l,minFinalityThreshold:p}=i,m=new pt(o,st.abi).interface.encodeFunctionData("createOrder",[r,c,u,l,p,s]),f=le(0);return{to:o,data:m,value:f,_params:i}}function Mn(e,t,n,a,i,o){if(e.type!=="FAST_MCTP")throw new Error("Quote type is not FAST_MCTP");if(!Number.isFinite(Number(a)))throw new Error("Invalid signer chain id");a=Number(a);let s=i||X,r=new pt(d.MAYAN_FORWARDER_CONTRACT,q.abi);if(e.fromToken.contract===e.fastMctpInputContract)if(e.hasAuction){if(!Number(e.deadline64))throw new Error("Fast Mctp order requires timeout");let c=In(e,t,n,a),u="forwardERC20",l=[e.fromToken.contract,c._params.amountIn,s,c._params.contractAddress,c.data];return{data:r.interface.encodeFunctionData(u,l),to:d.MAYAN_FORWARDER_CONTRACT,value:le(0),chainId:a,_forwarder:{method:u,params:l}}}else{let c=hn(e,t,n,a,o),u="forwardERC20",l=[e.fromToken.contract,c._params.amountIn,s,c._params.contractAddress,c.data];return{data:r.interface.encodeFunctionData(u,l),to:d.MAYAN_FORWARDER_CONTRACT,value:le(0),chainId:a,_forwarder:{method:u,params:l}}}else{let{minMiddleAmount:c,evmSwapRouterAddress:u,evmSwapRouterCalldata:l}=e;if(!c||!u||!l)throw new Error("Fast Mctp swap requires middle amount, router address and calldata");if(e.hasAuction){if(!Number(e.deadline64))throw new Error("Fast Mctp order requires timeout");let p=In(e,t,n,a),y=w(e.minMiddleAmount,L);if(e.fromToken.contract===ot){let m="swapAndForwardEth",f=[p._params.amountIn,u,l,e.fastMctpInputContract,y,p._params.contractAddress,p.data];return{data:r.interface.encodeFunctionData(m,f),to:d.MAYAN_FORWARDER_CONTRACT,value:le(p._params.amountIn),chainId:a,_forwarder:{method:m,params:f}}}else{let m="swapAndForwardERC20",f=[e.fromToken.contract,p._params.amountIn,s,u,l,e.fastMctpInputContract,y,p._params.contractAddress,p.data];return{data:r.interface.encodeFunctionData(m,f),to:d.MAYAN_FORWARDER_CONTRACT,value:le(0),chainId:a,_forwarder:{method:m,params:f}}}}else{let p=hn(e,t,n,a,o),y=w(e.minMiddleAmount,L);if(e.fromToken.contract===ot){let m="swapAndForwardEth",f=[p._params.amountIn,u,l,e.fastMctpInputContract,y,p._params.contractAddress,p.data];return{data:r.interface.encodeFunctionData(m,f),to:d.MAYAN_FORWARDER_CONTRACT,value:le(p._params.amountIn),chainId:a,_forwarder:{method:m,params:f}}}else{let m="swapAndForwardERC20",f=[e.fromToken.contract,p._params.amountIn,s,u,l,e.fastMctpInputContract,y,p._params.contractAddress,p.data];return{data:r.interface.encodeFunctionData(m,f),to:d.MAYAN_FORWARDER_CONTRACT,value:le(0),chainId:a,_forwarder:{method:m,params:f}}}}}}function Ea(e,t,n,a,i,o){let s=new lt(d.MAYAN_PROGRAM_ID),[r]=lt.findProgramAddressSync([Buffer.from("MAIN")],s),c=F(new lt(e.fromToken.mint),r,!0),u=BigInt(e.effectiveAmountIn64),l=A(c.toString(),1),p=A(d.AUCTION_PROGRAM_ID,1),y;n?y=A(n,1):y=A(_a.programId.toString(),1);let m=H(Number(i)),f=k(e.fromChain),b=k(e.toChain);if(f!==m)throw new Error(`Signer chain id(${Number(i)}) and quote from chain are not same! ${f} !== ${m}`);let T=e.whMayanContract,h={mayanAddr:l,mayanChainId:1,destAddr:A(t,b),destChainId:b,auctionAddr:p,referrer:y,refundAddr:A(a,m)},g=e.toToken.contract===Cn,S={transferDeadline:BigInt(e.deadline64),swapDeadline:BigInt(e.deadline64),amountOutMin:w(e.minAmountOut,Math.min(8,e.toToken.decimals)),gasDrop:w(e.gasDrop,Math.min(8,B(e.toChain))),unwrap:g,customPayload:o?`0x${Buffer.from(o).toString("hex")}`:"0x"},R={swapFee:w(e.swapRelayerFee,Math.min(8,e.fromToken.decimals)),redeemFee:w(e.redeemRelayerFee,Math.min(8,e.toToken.decimals)),refundFee:w(e.refundRelayerFee,Math.min(8,e.fromToken.decimals))},C=A(e.toToken.realOriginContractAddress,e.toToken.realOriginChainId),I=w(e.bridgeFee,18);return{amountIn:u,tokenIn:e.fromToken.contract,tokenOut:C,tokenOutWChainId:e.toToken.realOriginChainId,criteria:S,recipient:h,relayerFees:R,contractAddress:T,bridgeFee:I}}function ct(e,t,n,a,i,o,s,r){let c=H(Number(o)),u=k(e.fromChain);if(u!==c)throw new Error(`Signer chain id(${Number(o)}) and quote from chain are not same! ${u} !== ${c}`);let l=he(e,a);if(e.type==="MCTP")return _t(e,n,l,o,r,s);if(e.type==="SWIFT")return fn(e,t,n,l,o,r);if(e.type==="SHUTTLE")return An(e,n,o,r);if(e.type==="FAST_MCTP")return Mn(e,n,l,o,r,s);if(e.type!="WH")throw new Error("Unsupported quote type");if(!Number(e.deadline64))throw new Error("WH mode requires a timeout");let{relayerFees:p,recipient:y,tokenOut:m,tokenOutWChainId:f,criteria:b,tokenIn:T,amountIn:h,contractAddress:g,bridgeFee:S}=Ea(e,n,l,i,o,s),R=new Sn(d.MAYAN_FORWARDER_CONTRACT,q.abi),C=new Sn(g,Pt.abi),I,E,x,K=r||X;if(T===Cn){let P=C.interface.encodeFunctionData("wrapAndSwapETH",[p,y,m,f,b]);I="forwardEth",E=[g,P],x=Pn(h)}else{let P=C.interface.encodeFunctionData("swap",[p,y,m,f,b,T,h]);I="forwardERC20",E=[T,h,K,g,P],x=Pn(S)}let W=R.interface.encodeFunctionData(I,E);return{to:d.MAYAN_FORWARDER_CONTRACT,data:W,value:x,chainId:o,_forwarder:{method:I,params:E}}}async function rs(e,t,n,a,i,o,s,r){if(!i.provider)throw new Error("No provider found for signer");let c=await i.getAddress();if(c.toLowerCase()!==t.toLowerCase())throw new Error("Signer address does not match swapper address");let u=Number((await i.provider.getNetwork()).chainId);if(e.type==="SWIFT"&&e.gasless){let p=he(e,a),y=bn(e,t,n,p,u,o),m=await i.signTypedData(y.orderTypedData.domain,y.orderTypedData.types,y.orderTypedData.value);return await Mt(y,m),y.orderHash}let l=ct(e,t,n,a,c,u,r,o);if(delete l._forwarder,s?.gasPrice&&(l.gasPrice=s.gasPrice),s?.maxFeePerGas&&(l.maxFeePerGas=s.maxFeePerGas),s?.maxPriorityFeePerGas&&(l.maxPriorityFeePerGas=s.maxPriorityFeePerGas),s?.gasLimit)l.gasLimit=s.gasLimit;else{let p=await i.estimateGas(l);l.gasLimit=String(BigInt(String(p))*BigInt(110)/BigInt(100))}return l.chainId=mt(e.fromChain),i.sendTransaction(l)}async function is(e,t,n,a,i){let o=await n.getAddress(),s=e.toChain==="solana"?"ENsytooJVSZyNHbxvueUeX8Am8gcNqPivVVE8USCBiy5":"0x1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a",r=Number((await n.provider.getNetwork()).chainId);if(e.type==="SWIFT"&&e.gasless)return BigInt(0);let c=ct(e,t,s,null,o,r,i,a);delete c._forwarder;let u=await n.estimateGas(c);return u=BigInt(String(u)),e.type==="MCTP"||e.type==="SWIFT"?u*BigInt(110)/BigInt(100):u}async function ss(e,t,n,a){let i="0x1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a",o=e.toChain==="solana"?"ENsytooJVSZyNHbxvueUeX8Am8gcNqPivVVE8USCBiy5":"0x1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a1a",s=e?.fromToken?.chainId;if(e.type==="SWIFT"&&e.gasless)return BigInt(0);let r=ct(e,i,o,null,i,s,a,n);return delete r._forwarder,t.estimateGas(r)}export{At as FAST_MCTP_PAYLOAD_TYPE_CUSTOM_PAYLOAD,wt as FAST_MCTP_PAYLOAD_TYPE_DEFAULT,ht as FAST_MCTP_PAYLOAD_TYPE_ORDER,Na as MCTP_INIT_ORDER_PAYLOAD_ID,gt as MCTP_PAYLOAD_TYPE_CUSTOM_PAYLOAD,Tt as MCTP_PAYLOAD_TYPE_DEFAULT,X as ZeroPermit,d as addresses,Ht as broadcastJitoBundleId,ft as checkSdkVersionSupport,Gt as confirmJitoBundleId,Kt as createApproveInstruction,$ as createAssociatedTokenAccountInstruction,ea as createCloseAccountInstruction,Be as createInitializeRandomTokenAccountInstructions,nn as createMctpFromSolanaInstructions,Me as createSplTransferInstruction,Ia as createSwapFromSolanaInstructions,sn as createSwiftFromSolanaInstructions,tt as createSwiftOrderHash,Ie as createSyncNativeInstruction,We as createTransferAllAndCloseInstruction,Ne as decentralizeClientSwapInstructions,Lt as decideRelayer,Ee as deserializeInstructionInfo,is as estimateQuoteRequiredGas,ss as estimateQuoteRequiredGasAprox,Ua as fetchAllTokenList,Ha as fetchQuote,Ga as fetchTokenList,Qn as generateFetchQuoteUrl,ve as getAddressLookupTableAccounts,w as getAmountOfFractionalAmount,Z as getAnchorInstructionData,F as getAssociatedTokenAddress,Qa as getCurrentChainTime,va as getDisplayAmount,mt as getEvmChainIdByName,B as getGasDecimal,bt as getGasDecimalsInSolana,Ut as getJitoTipTransfer,_t as getMctpFromEvmTxPayload,he as getQuoteSuitableReferrerAddress,_ as getSafeU64Blob,$e as getSdkVersion,It as getSuggestedRelayer,ct as getSwapFromEvmTxPayload,Re as getSwapSolana,H as getWormholeChainIdById,k as getWormholeChainIdByName,N as hexToUint8Array,Gn as isValidAptosType,A as nativeAddressToHexString,qe as sendJitoBundle,te as solMint,Mt as submitSwiftEvmSwap,St as submitSwiftSolanaSwap,xe as submitTransactionWithRetry,rs as swapFromEvm,ui as swapFromSolana,wr as unwrapSol,Se as validateJupSwap,ke as wait,gr as wrapSol};
